<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/ico" href="/favicon.ico"><meta name="generator" content="Astro v5.17.1"><link rel="alternate" type="application/rss+xml" title="Laurent Kemp√© blog" href="https://laurentkempe.com/atom.xml"><title>Laurent Kemp√© - Azure DevOps for Visual Studio Extensions</title><!-- JSON-LD structured data --><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Azure DevOps for Visual Studio Extensions","datePublished":"2019-03-05T22:14:42.000Z","image":"https://farm5.staticflickr.com/4350/36640551660_cb7e3db2b0_b.jpg","description":"<div class=\"prose dark:prose-invert max-w-none mb-4 text-gray-900 dark:text-gray-100\"><p>As you might have guessed reading some of my older posts, I like to automate things which I believe a computer should do in place of humans.</p>\n</div>","author":{"@type":"Person","name":"Laurent Kemp√©","url":"https://laurentkempe.com","jobTitle":"Team Leader & Distinguished Solution Architect","image":"https://live.staticflickr.com/65535/54218216293_4d1b48b283_w.jpg","sameAs":["https://github.com/laurentkempe","https://www.linkedin.com/in/laurentkempe/","https://bsky.app/profile/laurentkempe.com","https://www.flickr.com/people/laurentkempe/","https://x.com/laurentkempe"]},"publisher":{"@type":"Person","name":"Laurent Kemp√©","url":"https://laurentkempe.com","jobTitle":"Team Leader & Distinguished Solution Architect","image":"https://live.staticflickr.com/65535/54218216293_4d1b48b283_w.jpg","sameAs":["https://github.com/laurentkempe","https://www.linkedin.com/in/laurentkempe/","https://bsky.app/profile/laurentkempe.com","https://x.com/laurentkempe"]},"mainEntityOfPage":{"@type":"WebPage","@id":"https://laurentkempe.com/2019/03/05/Azure-DevOps-for-Visual-Studio-Extensions/"},"keywords":"Azure DevOps, Visual Studio, Chocolatey, GitHub","url":"https://laurentkempe.com/2019/03/05/Azure-DevOps-for-Visual-Studio-Extensions/"}</script><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:title" content="Laurent Kemp√© - Azure DevOps for Visual Studio Extensions"><meta property="og:description" content="As you might have guessed reading some of my older posts, I like to automate things which I believe a computer should do in place of humans."><meta property="og:image" content="https://farm5.staticflickr.com/4350/36640551660_cb7e3db2b0_b.jpg"><meta property="og:url" content="https://laurentkempe.com/2019/03/05/Azure-DevOps-for-Visual-Studio-Extensions/"><meta property="og:site_name" content="Laurent Kemp√©"><meta property="article:author" content="https://laurentkempe.com"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@laurentkempe"><meta name="twitter:creator" content="@laurentkempe"><meta name="twitter:title" content="Laurent Kemp√© - Azure DevOps for Visual Studio Extensions"><meta name="twitter:description" content="As you might have guessed reading some of my older posts, I like to automate things which I believe a computer should do in place of humans."><meta name="twitter:image" content="https://farm5.staticflickr.com/4350/36640551660_cb7e3db2b0_b.jpg"><!-- Author --><meta name="author" content="Laurent Kemp√©"><!-- Canonical URL --><link rel="canonical" href="https://laurentkempe.com/2019/03/05/Azure-DevOps-for-Visual-Studio-Extensions/"><link rel="stylesheet" href="/_astro/_slug_.D4bdc-2k.css">
<style>.giscus-container[data-astro-cid-qdzwzgpn]{width:100%}.giscus-container[data-astro-cid-qdzwzgpn] iframe[data-astro-cid-qdzwzgpn]{color-scheme:auto}
a[data-astro-cid-5grsw2hi]{color:#00539f}.tags[data-astro-cid-5grsw2hi]{display:flex;flex-wrap:wrap}.tag[data-astro-cid-5grsw2hi]{margin:.25em;border:dotted 1px #a1a1a1;border-radius:.5em;padding:.5em 1em;font-size:1.15em;background-color:#f8fcfd}@media(prefers-color-scheme:dark){a[data-astro-cid-5grsw2hi]{color:#7fb3d5}.tag[data-astro-cid-5grsw2hi]{border-color:#5a5a5a;background-color:#2d2d2d}}body,html{margin:0;padding:0;width:100%;overflow-x:hidden}.relative[data-astro-cid-5grsw2hi]{width:100%}.absolute[data-astro-cid-5grsw2hi]{max-width:100%}
</style><style>.twitter-tweet:not(.twitter-tweet-rendered){padding:var(--tc-padding, 1em);border:1px solid var(--tc-border-color, #cfd9de)}.twitter-tweet:not(.twitter-tweet-rendered)>:first-child{margin-top:0}.twitter-tweet:not(.twitter-tweet-rendered)>:last-child{margin-bottom:0}.twitter-tweet.twitter-tweet-rendered{color-scheme:normal}
</style><style>lite-youtube>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}
</style><style>lite-youtube{background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover;cursor:pointer;max-width:720px}lite-youtube:before{content:attr(data-title);display:block;position:absolute;top:0;background-image:linear-gradient(180deg,#000000ab,#0000008a 14%,#00000026 54%,#0000000d 72%,#0000 94%);height:99px;width:100%;font-family:YouTube Noto,Roboto,Arial,Helvetica,sans-serif;color:#eee;text-shadow:0 0 2px rgba(0,0,0,.5);font-size:18px;padding:25px 20px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box}lite-youtube:hover:before{color:#fff}lite-youtube:after{content:"";display:block;padding-bottom:56.25%}lite-youtube>iframe{width:100%;height:100%;position:absolute;top:0;left:0;border:0}lite-youtube>.lty-playbtn{display:block;width:100%;height:100%;background:no-repeat center/68px 48px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z" fill="red"/><path d="M45 24 27 14v20" fill="white"/></svg>');position:absolute;cursor:pointer;z-index:1;filter:grayscale(100%);transition:filter .1s cubic-bezier(0,0,.2,1);border:0}lite-youtube:hover>.lty-playbtn,lite-youtube .lty-playbtn:focus{filter:none}lite-youtube.lyt-activated{cursor:unset}lite-youtube.lyt-activated:before,lite-youtube.lyt-activated>.lty-playbtn{opacity:0;pointer-events:none}.lyt-visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}
</style></head> <body class="bg-white dark:bg-gray-900"> <header class="py-6 border-b border-gray-200 dark:border-gray-700 container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl"> <nav class="container mx-auto px-4"> <div class="flex items-center justify-between"> <div class="text-2xl font-bold dark:text-gray-300"> <a href="/">Laurent Kemp√©</a> </div> <!-- Mobile menu button and utilities --> <div class="flex items-center gap-4 md:hidden text-gray-600 dark:text-gray-300"> <div class="flex items-center gap-4"> <a href="/atom.xml" aria-label="RSS Feed" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path> </svg> </a> <theme-toggle> <button title="Dark/Light mode" aria-pressed="false" aria-label="Toggle dark mode" class="focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"></button> </theme-toggle> <script type="module">const i=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
    <circle cx="12" cy="12" r="5"/>
    <g stroke="currentColor" stroke-width="2" stroke-linecap="round">
      <line x1="12" y1="1" x2="12" y2="3"/>
      <line x1="12" y1="21" x2="12" y2="23"/>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
      <line x1="1" y1="12" x2="3" y2="12"/>
      <line x1="21" y1="12" x2="23" y2="12"/>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
    </g>
  </svg>`,n=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
    <path d="M17.293 13.293a8 8 0 11-10.586-10.586 8.003 8.003 0 0010.586 10.586z"/>
  </svg>`;class r extends HTMLElement{STORAGE_KEY="theme-preference";_darkTheme=!1;button;constructor(){if(super(),this.button=this.querySelector("button"),!this.button){console.error("Theme toggle button not found");return}const e=localStorage.getItem(this.STORAGE_KEY);e?this.darkTheme=e==="dark":this.darkTheme=window.matchMedia("(prefers-color-scheme: dark)").matches,this.button.addEventListener("click",this.toggleTheme.bind(this)),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{localStorage.getItem(this.STORAGE_KEY)||(this.darkTheme=t.matches)})}get darkTheme(){return this._darkTheme}set darkTheme(e){if(this._darkTheme=e,document.documentElement.classList.toggle("dark",e),this.button){this.button.innerHTML=e?i:n,this.button.setAttribute("aria-label",e?"Switch to light theme":"Switch to dark theme"),this.button.setAttribute("aria-pressed",e.toString());const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("class","sr-only"),t.textContent=e?"Dark theme enabled":"Light theme enabled",this.appendChild(t),setTimeout(()=>{t.parentNode===this&&this.removeChild(t)},1e3)}}toggleTheme(){this.darkTheme=!this.darkTheme,localStorage.setItem(this.STORAGE_KEY,this.darkTheme?"dark":"light")}}customElements.define("theme-toggle",r);</script> </div> <button id="mobile-menu-button" aria-expanded="false" aria-controls="mobile-menu" aria-label="Toggle menu" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"> <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </button> </div> <!-- Desktop menu --> <div class="hidden md:flex md:items-center md:gap-6 text-gray-600 dark:text-gray-300"> <a href="/" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 ">Home</a> <a href="/blog/1" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 ">Blog</a> <a href="/speaking" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 ">Speaking</a> <a href="/about-laurent-kempe" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 ">About</a> <a href="/all-archives" aria-label="Archives" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 "> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"></path> </svg> </a> <a href="/all-tags" aria-label="Tags" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 "> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path> <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path> </svg> </a> <a href="/atom.xml" aria-label="RSS Feed" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path> </svg> </a> <theme-toggle> <button title="Dark/Light mode" aria-pressed="false" aria-label="Toggle dark mode" class="focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"></button> </theme-toggle>  </div> </div> <!-- Mobile menu panel --> <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4" role="menu" aria-labelledby="mobile-menu-button"> <div class="flex flex-col gap-4 text-gray-600 dark:text-gray-300"> <a href="/" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 " role="menuitem">Home</a> <a href="/blog/1" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 " role="menuitem">Blog</a> <a href="/speaking" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 " role="menuitem">Speaking</a> <a href="/about-laurent-kempe" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 " role="menuitem">About</a> <a href="/all-archives" aria-label="Archives" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 "> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"></path> </svg> </a> <a href="/all-tags" aria-label="Tags" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 "> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path> <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path> </svg> </a> </div> </div> </nav> </header> <script type="module">const i=document.getElementById("mobile-menu-button"),o=document.getElementById("mobile-menu");let n=[],s,u;function c(){o?.classList.remove("hidden"),i?.setAttribute("aria-expanded","true"),n=o?.querySelectorAll('a[href], button, textarea, input[type="text"], input[type="radio"], input[type="checkbox"], select'),n.length&&(s=n[0],u=n[n.length-1],setTimeout(()=>{s.focus()},50)),l("Menu opened")}function d(){o?.classList.add("hidden"),i?.setAttribute("aria-expanded","false"),i?.focus(),l("Menu closed")}function l(e){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("class","sr-only"),t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentNode===document.body&&document.body.removeChild(t)},1e3)}i?.addEventListener("click",()=>{o?.classList.contains("hidden")===!1?d():c()});document.addEventListener("keydown",e=>{if(!o?.classList.contains("hidden")){if(e.key==="Escape"){d();return}e.key==="Tab"&&(e.shiftKey&&document.activeElement===s?(e.preventDefault(),u.focus()):!e.shiftKey&&document.activeElement===u&&(e.preventDefault(),s.focus()))}});</script> <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">  <p data-astro-cid-5grsw2hi><em data-astro-cid-5grsw2hi></em></p>  <div class="relative pt-1 cover-image-container" data-astro-cid-5grsw2hi> <img src="https://farm5.staticflickr.com/4350/36640551660_cb7e3db2b0_b.jpg" alt="Moorea, Polyn√©sie fran√ßaise, France" data-astro-cid-5grsw2hi="true" loading="lazy" decoding="async" fetchpriority="auto" width="1600" height="1067" class="w-full"> <div class="absolute text-white top-1/3 left-1/3 transform -translate-x-1/4 -translate-y-1/4" data-astro-cid-5grsw2hi> <p class="text-2xl sm:text-3xl md:text-5xl font-extrabold drop-shadow-[0_4px_3px_rgb(0,0,0,0.5)] dark:drop-shadow-[0_4px_3px_rgb(255,255,255,0.5)]" data-astro-cid-5grsw2hi>Azure DevOps for Visual Studio Extensions</p> <p class="py-2 text-sm sm:text-base" data-astro-cid-5grsw2hi>Mar 5, 2019</p> </div> <p class="absolute text-sm sm:text-xs text-white bottom-5 right-5 hidden md:block" data-astro-cid-5grsw2hi>Moorea, Polyn√©sie fran√ßaise, France</p> <div class="absolute bottom-5 left-5 hidden md:block" data-astro-cid-5grsw2hi> <div class="flex gap-1 flex-wrap"><a href="/tags/azure-devops" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">Azure DevOps</a><a href="/tags/chocolatey" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">Chocolatey</a><a href="/tags/github" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">GitHub</a><a href="/tags/visual-studio" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">Visual Studio</a></div> </div> </div> <p class="text-sm text-center py-2 text-gray-600 dark:text-gray-400 block md:hidden" data-astro-cid-5grsw2hi>Moorea, Polyn√©sie fran√ßaise, France</p><div class="py-2 block md:hidden" data-astro-cid-5grsw2hi> <div class="flex gap-1 flex-wrap"><a href="/tags/azure-devops" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">Azure DevOps</a><a href="/tags/chocolatey" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">Chocolatey</a><a href="/tags/github" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">GitHub</a><a href="/tags/visual-studio" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">Visual Studio</a></div> </div><div class="py-4" data-astro-cid-5grsw2hi>  <article class="prose prose-lg max-w-none dark:prose-invert
                    prose-h1:font-bold prose-h1:text-4xl md:prose-h1:text-4xl prose-h1:text-xl prose-h1:mb-4
                    prose-a:text-blue-600 dark:prose-a:text-blue-400 prose-a:no-underline
                    prose-p:text-justify prose-img:rounded-xl"> <p>As you might have guessed reading some of my older posts, I like to automate things which I believe a computer should do in place of humans.</p>

<p>It is true for ‚Äú<a href="https://laurentkempe.com/2018/06/01/Automating-development-machine-installation/">Automating my development machine installation</a>‚Äù or deploying software in ‚Äú<a href="https://laurentkempe.com/2016/07/18/Build-ship-and-run-ASP-NET-Core-on-Microsoft-Azure-using-Docker-Cloud/">Build, ship and run ASP.NET Core on Microsoft Azure using Docker Cloud</a>‚Äù‚Ä¶ Today I will show you how to publish Visual Studio extensions using <a href="https://azure.microsoft.com/en-us/services/devops/">Azure DevOps</a>.</p>
<p>I am the author of <strong><a href="https://marketplace.visualstudio.com/items?itemName=LaurentKempe.GitDiffMargin">Git Diff Margin</a></strong>, a Visual Studio extension displaying live Git changes of the currently edited file on Visual Studio margin and scroll bar. It supports Visual Studio 2012 through Visual Studio 2019 Preview. You can <a href="#Git-Diff-Margin-feature-demo">watch a short video</a> about some of its features at the end of this blog post.</p>
<h1 id="previously">Previously</h1>
<p>My way of releasing <a href="https://github.com/laurentkempe/GitDiffMargin">Git Diff Margin</a> was tedious with lots of manual steps<p></p></p>
<ol>
<li>Update versions in all AssemblyInfo.cs, in source.extension.vsixmanifest</li>
<li>Build on my local machine</li>
<li>Get the vsix, install it in Visual Studio and test it</li>
<li>Tag with Git and push to Github</li>
<li>Login to the Visual Studio marketplace, upload by hand the vsix, adapt the description and publish</li>
<li>Create a release on Github, upload by hand the vsix, adapt the description and publish</li>
<li>Login to Chocolatey.org, upload by hand the nupkg, adapt the description and publish</li>
</ol>
<p>There is clearly lots of place for some automation.</p>
<h1 id="first-improvement">First improvement</h1>
<p>For some time, I have used <a href="https://www.appveyor.com/">AppVeyor</a> to at least have a Continuous Integration build. This was helping already to be sure that a Pull Request would build correctly and to get the vsix artifact built somewhere else than on my developer machine.</p>
<p>A good step for sure, but not enough to please me.</p>
<h1 id="today">Today</h1>
<p>I have greatly reduced the burden using <a href="https://azure.microsoft.com/en-us/services/devops/">Azure DevOps</a> üíï and this <strong>at no cost</strong>!
Microsoft is supporting the open source community with <a href="https://azure.microsoft.com/en-us/services/devops/pipelines/">Azure Pipelines</a> with 10 parallel jobs with unlimited minutes for CI/CD! Thanks for that.</p>
<p>You can watch a great quick intro video from <a href="https://twitter.com/AbelSquidHead">Abel Wang</a> to get a better idea</p>
<lite-youtube videoid="NuYDAs3kNV8" class="yt-width" style="background-image: url('https://i.ytimg.com/vi/NuYDAs3kNV8/hqdefault.jpg');"> <a href="https://youtube.com/watch?v=NuYDAs3kNV8" class="lty-playbtn"> <span class="lyt-visually-hidden">Play</span> </a> </lite-youtube> <script type="module">class i extends HTMLElement{connectedCallback(){this.videoId=this.getAttribute("videoid");let e=this.querySelector(".lty-playbtn");if(this.playLabel=e&&e.textContent.trim()||this.getAttribute("playlabel")||"Play",this.dataset.title=this.getAttribute("title")||"",this.style.backgroundImage||(this.style.backgroundImage=`url("https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg")`,this.upgradePosterImage()),e||(e=document.createElement("button"),e.type="button",e.classList.add("lty-playbtn"),this.append(e)),!e.textContent){const t=document.createElement("span");t.className="lyt-visually-hidden",t.textContent=this.playLabel,e.append(t)}this.addNoscriptIframe(),e.nodeName==="A"&&(e.removeAttribute("href"),e.setAttribute("tabindex","0"),e.setAttribute("role","button"),e.addEventListener("keydown",t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),this.activate())})),this.addEventListener("pointerover",i.warmConnections,{once:!0}),this.addEventListener("focusin",i.warmConnections,{once:!0}),this.addEventListener("click",this.activate),this.needsYTApi=this.hasAttribute("js-api")||navigator.vendor.includes("Apple")||navigator.userAgent.includes("Mobi")}static addPrefetch(e,t,a){const r=document.createElement("link");r.rel=e,r.href=t,a&&(r.as=a),document.head.append(r)}static warmConnections(){i.preconnected||(i.addPrefetch("preconnect","https://www.youtube-nocookie.com"),i.addPrefetch("preconnect","https://www.google.com"),i.addPrefetch("preconnect","https://googleads.g.doubleclick.net"),i.addPrefetch("preconnect","https://static.doubleclick.net"),i.preconnected=!0)}fetchYTPlayerApi(){window.YT||window.YT&&window.YT.Player||(this.ytApiPromise=new Promise((e,t)=>{var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api",a.async=!0,a.onload=r=>{YT.ready(e)},a.onerror=t,this.append(a)}))}async getYTPlayer(){return this.playerPromise||await this.activate(),this.playerPromise}async addYTPlayerIframe(){this.fetchYTPlayerApi(),await this.ytApiPromise;const e=document.createElement("div");this.append(e);const t=Object.fromEntries(this.getParams().entries());this.playerPromise=new Promise(a=>{let r=new YT.Player(e,{width:"100%",videoId:this.videoId,playerVars:t,events:{onReady:n=>{n.target.playVideo(),a(r)}}})})}addNoscriptIframe(){const e=this.createBasicIframe(),t=document.createElement("noscript");t.innerHTML=e.outerHTML,this.append(t)}getParams(){const e=new URLSearchParams(this.getAttribute("params")||[]);return e.append("autoplay","1"),e.append("playsinline","1"),e}async activate(){if(this.classList.contains("lyt-activated"))return;if(this.classList.add("lyt-activated"),this.needsYTApi)return this.addYTPlayerIframe(this.getParams());const e=this.createBasicIframe();this.append(e),e.focus()}createBasicIframe(){const e=document.createElement("iframe");return e.width=560,e.height=315,e.title=this.playLabel,e.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",e.allowFullscreen=!0,e.src=`https://www.youtube-nocookie.com/embed/${encodeURIComponent(this.videoId)}?${this.getParams().toString()}`,e}upgradePosterImage(){setTimeout(()=>{const e=`https://i.ytimg.com/vi_webp/${this.videoId}/sddefault.webp`,t=new Image;t.fetchPriority="low",t.referrerpolicy="origin",t.src=e,t.onload=a=>{a.target.naturalHeight==90&&a.target.naturalWidth==120||(this.style.backgroundImage=`url("${e}")`)}},100)}}customElements.define("lite-youtube",i);</script> 
<br/>
<h2 id="build-pipeline">Build pipeline</h2>
<p>So, creating a build pipeline on Azure DevOps is the first step and it is super easy! It comes in two flavors; one with a <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/get-started-designer?view=azure-devops&tabs=new-nav">visual editor</a> and one as a <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/yaml-schema?view=azure-devops&tabs=schema">YAML file</a>.</p>
<p>The overall goal of the build pipeline is to<p></p></p>
<ol>
<li>Start a build when something changes on the master branch of <a href="https://github.com/laurentkempe/GitDiffMargin">Git Diff Margin Github repository</a></li>
<li>Produce artifacts resulting from a successful build</li>
</ol>
<p>To achieve this here are the steps executed by the build pipeline<p></p></p>
<ol>
<li><a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/tool/nuget?view=azure-devops">Installing Nuget Tool</a></li>
<li>Updating all AssemblyInfo.cs automatically using <a href="https://marketplace.visualstudio.com/items?itemName=bleddynrichards.Assembly-Info-Task">Assembly Info extension</a></li>
<li>Update Git Diff Margin Vsix Version using <a href="https://marketplace.visualstudio.com/items?itemName=SamirBoulema.Vsix-Tools">Vsix Tools extension</a></li>
<li>Building Git Diff Margin Visual Studio solution using <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/build/visual-studio-build?view=azure-devops">Visual Studio Build task</a></li>
<li>Running the tests. ‚ùó Currently, I still need to have this working</li>
<li><a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/copy-files?view=azure-devops&tabs=yaml">Copy</a> build artifacts to a staging folder and to the Chocolatey folder</li>
<li>Run <a href="https://marketplace.visualstudio.com/items?itemName=gep13.chocolatey-azuredevops">Chocolatey pack</a></li>
<li>Finally, <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/publish-build-artifacts?view=azure-devops">publish the build artifacts</a> so that they can be downloaded later on</li>
</ol>
<p>You can see that we already automated a good part of the manual tasks that we had to do previously. In fact, now we still need to update the version manually but only in one place which is the Azure DevOps YAML file: <em>azure-pipelines.yml</em>.</p>
<p>The remaining manual tasks are</p>
<ol>
<li>Get the vsix, install it in Visual Studio and test it</li>
<li>Update README-Marketplace.md file which will be uploaded to the Visual Studio Marketplace as a description file</li>
<li>Tag with Git and push to Github</li>
</ol>
<p>This is the <em>azure-pipelines.yml</em> file which automates the whole build step!</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#6A737D"># .NET Desktop</span></span>
<span class="line"><span style="color:#6A737D"># Build and run tests for .NET Desktop or Windows classic desktop solutions.</span></span>
<span class="line"><span style="color:#6A737D"># Add steps that publish symbols, save build artifacts, and more:</span></span>
<span class="line"><span style="color:#6A737D"># https://docs.microsoft.com/azure/devops/pipelines/apps/windows/dot-net</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">pool</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  vmImage</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;VS2017-Win2016&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">variables</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  patch</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">$[counter(&#39;versioncounter&#39;, 0)]</span></span>
<span class="line"><span style="color:#85E89D">  solution</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;**/*.sln&#39;</span></span>
<span class="line"><span style="color:#85E89D">  buildPlatform</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Any CPU&#39;</span></span>
<span class="line"><span style="color:#85E89D">  buildConfiguration</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Release&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">name</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">3.9.3.$(patch)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">steps</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">NuGetToolInstaller@0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">NuGetCommand@2</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    restoreSolution</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(solution)&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">bleddynrichards.Assembly-Info-Task.Assembly-Info-Task.Assembly-Info-NetFramework@2</span></span>
<span class="line"><span style="color:#85E89D">  displayName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Update Assembly Version&#39;</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    VersionNumber</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.BuildNumber)&#39;</span></span>
<span class="line"><span style="color:#85E89D">    FileVersionNumber</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.BuildNumber)&#39;</span></span>
<span class="line"><span style="color:#85E89D">    InformationalVersion</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.BuildNumber)&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">VsixToolsUpdateVersion@1</span></span>
<span class="line"><span style="color:#85E89D">  displayName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Update Vsix Version&#39;</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    FileName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">$(Build.SourcesDirectory)\$(system.teamProject).Extension\source.extension.vsixmanifest</span></span>
<span class="line"><span style="color:#85E89D">    VersionNumber</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.BuildNumber)&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">  </span></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">VSBuild@1</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    solution</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(solution)&#39;</span></span>
<span class="line"><span style="color:#85E89D">    platform</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(buildPlatform)&#39;</span></span>
<span class="line"><span style="color:#85E89D">    configuration</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(buildConfiguration)&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">CopyFiles@2</span></span>
<span class="line"><span style="color:#85E89D">  displayName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Copy Artifacts to Staging&#39;</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">: </span></span>
<span class="line"><span style="color:#85E89D">    contents</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;**\?(*.vsix|extension-manifest.json|README-Marketplace.md)&#39;</span></span>
<span class="line"><span style="color:#85E89D">    targetFolder</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.ArtifactStagingDirectory)&#39;</span></span>
<span class="line"><span style="color:#85E89D">    flattenFolders</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">CopyFiles@2</span></span>
<span class="line"><span style="color:#85E89D">  displayName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Copy Vsix to Chocolatey&#39;</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">: </span></span>
<span class="line"><span style="color:#85E89D">    contents</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;**\?(*.vsix)&#39;</span></span>
<span class="line"><span style="color:#85E89D">    targetFolder</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.Repository.LocalPath)/ChocolateyPackage/GitDiffMargin/tools/&#39;</span></span>
<span class="line"><span style="color:#85E89D">    flattenFolders</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">gep13.chocolatey-azuredevops.chocolatey-azuredevops.ChocolateyCommand@0</span></span>
<span class="line"><span style="color:#85E89D">  displayName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Chocolatey pack&#39;</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    packWorkingDirectory</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.Repository.LocalPath)/ChocolateyPackage/GitDiffMargin/&#39;</span></span>
<span class="line"><span style="color:#85E89D">    packNuspecFileName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">GitDiffMargin.nuspec</span></span>
<span class="line"><span style="color:#85E89D">    packVersion</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.BuildNumber)&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">PublishBuildArtifacts@1</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    pathtoPublish</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(Build.ArtifactStagingDirectory)&#39;</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#85E89D">    artifactName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(system.teamProject)&#39;</span></span></code></pre>
<p>By the way, you can get nice <a href="https://docs.microsoft.com/en-us/rest/api/azure/devops/build/badge/get%20build%20badge%20data?view=azure-devops-rest-5.0">clickable build status badge</a> like the following one</p>
<p><a href="https://dev.azure.com/techheadbrothers/GitDiffMargin/_build/latest?definitionId=7"><img src="https://dev.azure.com/techheadbrothers/GitDiffMargin/_apis/build/status/laurentkempe.GitDiffMargin" alt="Build Status"/></a></p>
<h2 id="release-pipeline">Release pipeline</h2>
<p>Now that we have access to the build artifacts; <a href="https://marketplace.visualstudio.com/items?itemName=LaurentKempe.GitDiffMargin">GitDiffMargin.vsix for the Visual Studio Marketplace</a> and <a href="https://www.chocolatey.org/packages/GitDiffMargin">GitDiffMargin.nupkg for Chocolatey</a> we can automate the next step through a <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/release/?view=azure-devops">Azure DevOps release pipeline</a>.</p>
<p>In this step, we would like to automate the following</p>
<ol start="5">
<li>Login to the Visual Studio marketplace, upload by hand the vsix, adapt the description and publish</li>
<li>Create a draft release on Github, upload by hand the vsix, create a description based on changes</li>
<li>Login to Chocolatey.org, upload by hand the nupkg, adapt the description and publish</li>
</ol>
<p>For that, we created a release pipeline job named ‚ÄúMarketplace - Github - Choco‚Äù with 3 tasks connected to our previously defined build pipeline artifacts</p>
<img src="https://farm8.staticflickr.com/7807/32349146347_f88d9b1fce_o.png" alt="Azure DevOps Release pipeline" loading="lazy" decoding="async" fetchpriority="auto" width="100" height="100" class="container mx-auto px-4 py-4 flex flex-col sm:flex-row max-w-[640px]">
<p>In the details</p>
<img src="https://farm8.staticflickr.com/7840/47290958411_251b163117_o.png" alt="Azure DevOps Release pipeline tasks" loading="lazy" decoding="async" fetchpriority="auto" width="100" height="100" class="container mx-auto px-4 py-4 flex flex-col sm:flex-row max-w-[640px]">
<p>The first task publishes Git Diff Margin to Visual Studio Extension using <a href="https://marketplace.visualstudio.com/items?itemName=ms-devlabs.vsts-developer-tools-build-tasks">Azure DevOps Extension Tasks</a></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#85E89D">steps</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">ms-devlabs.vsts-developer-tools-build-tasks.publish-vs-extension-build-task.PublishVSExtension@1</span></span>
<span class="line"><span style="color:#85E89D">  displayName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Publish Visual Studio Extension&#39;</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  connectedServiceName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Visual Studio Marketplace&#39;</span></span>
<span class="line"><span style="color:#85E89D">  vsixFile</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(System.DefaultWorkingDirectory)/_GitDiffMargin CI/GitDiffMargin/GitDiffMargin.vsix&#39;</span></span>
<span class="line"><span style="color:#85E89D">  rootFolder</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(System.DefaultWorkingDirectory)/_GitDiffMargin CI/GitDiffMargin&#39;</span></span>
<span class="line"><span style="color:#85E89D">  publisherId</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">LaurentKempe</span></span></code></pre>
<p>The second task creates a GitHub release draft using <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/github-release?view=azure-devops">GitHub Release task</a></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#85E89D">steps</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">GitHubRelease@0</span></span>
<span class="line"><span style="color:#85E89D">  displayName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;GitHub release (create)&#39;</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    gitHubConnection</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">laurentkempe</span></span>
<span class="line"><span style="color:#85E89D">    repositoryName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">laurentkempe/GitDiffMargin</span></span>
<span class="line"><span style="color:#85E89D">    title</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;v$(Build.BuildNumber)&#39;</span></span>
<span class="line"><span style="color:#85E89D">    assets</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(System.DefaultWorkingDirectory)/_GitDiffMargin CI/GitDiffMargin/GitDiffMargin.vsix&#39;</span></span>
<span class="line"><span style="color:#85E89D">    isDraft</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">true</span></span></code></pre>
<p>The third task publish to Chocolatey using <a href="https://marketplace.visualstudio.com/items?itemName=gep13.chocolatey-azuredevops">Chocolatey</a></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#85E89D">steps</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">- </span><span style="color:#85E89D">task</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">gep13.chocolatey-azuredevops.chocolatey-azuredevops.ChocolateyCommand@0</span></span>
<span class="line"><span style="color:#85E89D">  displayName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Chocolatey push&#39;</span></span>
<span class="line"><span style="color:#85E89D">  inputs</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    command</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">push</span></span>
<span class="line"><span style="color:#85E89D">    pushWorkingDirectory</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;$(System.DefaultWorkingDirectory)/_GitDiffMargin CI/GitDiffMargin&#39;</span></span>
<span class="line"><span style="color:#85E89D">    pushNupkgFileName</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;GitDiffMargin.$(Build.BuildNumber).nupkg&#39;</span></span>
<span class="line"><span style="color:#85E89D">    pushApikey</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;YOUR_API_KEY&#39;</span></span></code></pre>
<p>The release pipeline is triggered manually when I am ready to publish a new version</p>
<img src="https://farm8.staticflickr.com/7820/46376429945_e3fde68d19_o.png" alt="Azure DevOps Releasing" loading="lazy" decoding="async" fetchpriority="auto" width="100" height="100" class="container mx-auto px-4 py-4 flex flex-col sm:flex-row max-w-[640px]">
<p>And if everything worked correctly you see the following result</p>
<img src="https://farm8.staticflickr.com/7883/40326503893_58116c2328_o.png" alt="Azure DevOps Release result" loading="lazy" decoding="async" fetchpriority="auto" width="100" height="100" class="container mx-auto px-4 py-4 flex flex-col sm:flex-row max-w-[640px]">
<p>And now people have access to the latest version of Git Diff Margin on <a href="https://marketplace.visualstudio.com/items?itemName=LaurentKempe.GitDiffMargin">Visual Studio Marketplace</a>, on <a href="https://github.com/laurentkempe/GitDiffMargin/releases/tag/v3.9.3">Github release</a> and on <a href="https://www.chocolatey.org/packages/GitDiffMargin/">Chocolatey</a>.</p>
<p>Finally, we achieved our goal and let the machines do the work, which saves us time and avoid some mistakes.</p>
<h1 id="thanks">Thanks</h1>
<ul>
<li><a href="https://www.gep13.co.uk/">Gary Ewan Park</a> aka <a href="https://twitter.com/gep13">@gep13</a> for the great help he provided me on the <a href="https://www.chocolatey.org/">Chocolatey</a> part of this journey!</li>
<li><a href="https://github.com/onlyutkarsh">Utkarsh Shigihalli</a> aka <a href="https://twitter.com/onlyutkarsh">@onlyutkarsh</a> for <a href="https://github.com/Microsoft/vsts-extension-build-release-tasks/issues/103">extending of Azure DevOps Extension Tasks for the Visual Studio marketplace</a></li>
</ul>
<h1 id="git-diff-margin-feature-demo">Git Diff Margin feature demo</h1>
<a data-flickr-embed="true" href="https://www.flickr.com/photos/laurentkempe/14879945429/" title="Git Diff Margin features demo"><img src="https://farm6.staticflickr.com/5562/14879945429_cc40e1db81_o.jpg" width="480" height="360" alt="Git Diff Margin features demo"/></a>
<script async src="//embedr.flickr.com/assets/client-code.js" charset="utf-8"></script> </article>  </div>  <div class="giscus-container mt-8 pt-8 border-t border-gray-200 dark:border-gray-700" data-astro-cid-qdzwzgpn> <div id="giscus-comments" data-astro-cid-qdzwzgpn></div> </div> <script>
  (function() {
    const STORAGE_KEY = "theme-preference";
    
    // Function to get current theme based on ThemeToggle logic
    function getCurrentTheme() {
      const savedTheme = localStorage.getItem(STORAGE_KEY);
      if (savedTheme) {
        return savedTheme === "dark" ? "dark" : "light";
      } else {
        return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
      }
    }
    
    // Function to get giscus theme name
    function getGiscusTheme(isDark) {
      return isDark ? "dark" : "light";
    }
    
    // Function to send theme change message to giscus iframe
    function updateGiscusTheme(theme) {
      const iframe = document.querySelector('iframe.giscus-frame');
      if (iframe) {
        iframe.contentWindow.postMessage({
          giscus: {
            setConfig: {
              theme: getGiscusTheme(theme === "dark")
            }
          }
        }, 'https://giscus.app');
      }
    }
    
    // Initialize giscus with correct theme
    const initialTheme = getCurrentTheme();
    const script = document.createElement('script');
    script.src = 'https://giscus.app/client.js';
    script.setAttribute('data-repo', 'laurentkempe/myblog-comments');
    script.setAttribute('data-repo-id', 'R_kgDOPHtNGA');
    script.setAttribute('data-category', 'General');
    script.setAttribute('data-category-id', 'DIC_kwDOPHtNGM4Csi4o');
    script.setAttribute('data-mapping', 'pathname');
    script.setAttribute('data-strict', '0');
    script.setAttribute('data-reactions-enabled', '1');
    script.setAttribute('data-emit-metadata', '0');
    script.setAttribute('data-input-position', 'bottom');
    script.setAttribute('data-theme', getGiscusTheme(initialTheme === "dark"));
    script.setAttribute('data-lang', 'en');
    script.setAttribute('data-loading', 'lazy');
    script.setAttribute('crossorigin', 'anonymous');
    script.async = true;
    
    const container = document.getElementById('giscus-comments');
    if (container) {
      container.appendChild(script);
    }
    
    // Listen for theme changes
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
          const isDark = document.documentElement.classList.contains('dark');
          updateGiscusTheme(isDark ? "dark" : "light");
        }
      });
    });
    
    // Start observing changes to the document element's class
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['class']
    });
    
    // Also listen for storage changes (in case theme is changed in another tab)
    window.addEventListener('storage', function(e) {
      if (e.key === STORAGE_KEY) {
        const newTheme = e.newValue === "dark" ? "dark" : "light";
        updateGiscusTheme(newTheme);
      }
    });
    
    // Listen for system theme changes when no preference is saved
    window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", function(e) {
      if (!localStorage.getItem(STORAGE_KEY)) {
        updateGiscusTheme(e.matches ? "dark" : "light");
      }
    });
  })();
</script>   </div> <footer class="py-8"> <div class="container mx-auto gap-4 px-4 text-sm text-gray-600 dark:text-gray-300 text-center"> <div>
&copy; 2003 - 2026 Laurent Kemp√©. All rights reserved.
</div> <div>
The expressed opinions are my own and do not reflect those of my employer or any third-party entities.
</div> </div> </footer> <script>
            const theme = (() => {
              if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
                return localStorage.getItem("theme");
              }
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                return "dark";
              }
              return "light";
            })();

            if (theme === "light") {
              document.documentElement.classList.remove("dark");
            } else {
              document.documentElement.classList.add("dark");
            }
            window.localStorage.setItem("theme", theme);
        </script> <script type="module">function a(t){const e=t.split(":").map(Number);return e.length===3?e[0]*3600+e[1]*60+e[2]:e.length===2?e[0]*60+e[1]:e.length===1?e[0]:0}function i(){return document.querySelector("lite-youtube")}function l(){const t=i();return t?t.querySelector("iframe"):null}function m(t){const e=i();if(!e){console.log("No lite-youtube element found");return}if(!e.getAttribute("videoid")){console.log("No video ID found on lite-youtube element");return}let o=l();if(o&&o.contentWindow){const r=o.src,n=new URL(r);n.searchParams.set("start",t.toString()),n.searchParams.set("autoplay","1"),o.src=n.toString(),console.log(`Seeking to ${t} seconds by updating iframe src`)}else e.setAttribute("params",`start=${t}&autoplay=1`),e.click(),console.log(`Starting video at ${t} seconds`);e.scrollIntoView({behavior:"smooth",block:"start"})}function f(){const t=document.querySelectorAll('a[href^="#timestamp-"]');t.length!==0&&(t.forEach(e=>{e.addEventListener("click",s=>{s.preventDefault();const o=e.getAttribute("href");if(!o)return;const r=o.match(/#timestamp-(\d{2}:\d{2}:\d{2})/);if(r){const n=r[1],u=a(n);console.log(`Seeking to ${n} (${u} seconds)`),m(u)}})}),console.log(`YouTube timestamp control: Set up ${t.length} timestamp links`))}function c(){const t=i()||document.querySelector('iframe[src*="youtube.com"]'),e=document.querySelector('a[href^="#timestamp-"]');!t||!e||f()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c();</script> </body> </html> 