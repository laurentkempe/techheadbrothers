<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/ico" href="/favicon.ico"><meta name="generator" content="Astro v5.16.0"><link rel="alternate" type="application/rss+xml" title="Laurent Kempé blog" href="https://laurentkempe.com/atom.xml"><title>Laurent Kempé - WPF and IOC on .NET Core 3.0</title><!-- JSON-LD structured data --><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"WPF and IOC on .NET Core 3.0","datePublished":"2019-04-18T10:57:56.000Z","image":"https://live.staticflickr.com/4410/36576108926_d296e0fa6b_h.jpg","description":"<div class=\"mb-4 text-gray-900 dark:text-gray-100\"><p>At work, we are planning to migrate our WPF application from .NET Framework 4.7 to <a href=\"https://docs.microsoft.com/en-us/dotnet/core/whats-new/dotnet-core-3-0\">.NET Core 3.0</a>. The main reason for doing so is that it was always a big pain to organize the updates of the .NET Framework on our customer machines. So being able to bundle .NET Core with our application is a big plus for us. Then, for sure, we are looking for the performance improvements brought by .NET Core and finally the new capabilities brought by the fast pace of innovation of .NET Core.</p>\n</div>","author":{"@type":"Person","name":"Laurent Kempé","url":"https://laurentkempe.com","jobTitle":"Team Leader & Distinguished Solution Architect","image":"https://live.staticflickr.com/65535/54218216293_4d1b48b283_w.jpg","sameAs":["https://github.com/laurentkempe","https://www.linkedin.com/in/laurentkempe/","https://bsky.app/profile/laurentkempe.com","https://www.flickr.com/people/laurentkempe/","https://x.com/laurentkempe"]},"publisher":{"@type":"Person","name":"Laurent Kempé","url":"https://laurentkempe.com","jobTitle":"Team Leader & Distinguished Solution Architect","image":"https://live.staticflickr.com/65535/54218216293_4d1b48b283_w.jpg","sameAs":["https://github.com/laurentkempe","https://www.linkedin.com/in/laurentkempe/","https://bsky.app/profile/laurentkempe.com","https://x.com/laurentkempe"]},"mainEntityOfPage":{"@type":"WebPage","@id":"https://laurentkempe.com/2019/04/18/WPF-and-IOC-on-NET-Core-3-0/"},"keywords":"WPF, .NET Core","url":"https://laurentkempe.com/2019/04/18/WPF-and-IOC-on-NET-Core-3-0/"}</script><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:title" content="Laurent Kempé - WPF and IOC on .NET Core 3.0"><meta property="og:description" content="At work, we are planning to migrate our WPF application from .NET Framework 4.7 to .NET Core 3.0. The main reason for doing so is that it was always a big pa..."><meta property="og:image" content="https://live.staticflickr.com/4410/36576108926_d296e0fa6b_h.jpg"><meta property="og:url" content="https://laurentkempe.com/2019/04/18/WPF-and-IOC-on-NET-Core-3-0/"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@laurentkempe"><meta name="twitter:title" content="Laurent Kempé - WPF and IOC on .NET Core 3.0"><meta name="twitter:description" content="At work, we are planning to migrate our WPF application from .NET Framework 4.7 to .NET Core 3.0. The main reason for doing so is that it was always a big pa..."><meta name="twitter:image" content="https://live.staticflickr.com/4410/36576108926_d296e0fa6b_h.jpg"><!-- Canonical URL --><link rel="canonical" href="https://laurentkempe.com/2019/04/18/WPF-and-IOC-on-NET-Core-3-0/"><link rel="stylesheet" href="/_astro/_slug_.DTuVyOEa.css">
<style>.giscus-container[data-astro-cid-qdzwzgpn]{width:100%}.giscus-container[data-astro-cid-qdzwzgpn] iframe[data-astro-cid-qdzwzgpn]{color-scheme:auto}
a[data-astro-cid-5grsw2hi]{color:#00539f}.tags[data-astro-cid-5grsw2hi]{display:flex;flex-wrap:wrap}.tag[data-astro-cid-5grsw2hi]{margin:.25em;border:dotted 1px #a1a1a1;border-radius:.5em;padding:.5em 1em;font-size:1.15em;background-color:#f8fcfd}@media(prefers-color-scheme:dark){a[data-astro-cid-5grsw2hi]{color:#7fb3d5}.tag[data-astro-cid-5grsw2hi]{border-color:#5a5a5a;background-color:#2d2d2d}}body,html{margin:0;padding:0;width:100%;overflow-x:hidden}.relative[data-astro-cid-5grsw2hi]{width:100%}.absolute[data-astro-cid-5grsw2hi]{max-width:100%}
</style><style>.twitter-tweet:not(.twitter-tweet-rendered){padding:var(--tc-padding, 1em);border:1px solid var(--tc-border-color, #cfd9de)}.twitter-tweet:not(.twitter-tweet-rendered)>:first-child{margin-top:0}.twitter-tweet:not(.twitter-tweet-rendered)>:last-child{margin-bottom:0}.twitter-tweet.twitter-tweet-rendered{color-scheme:normal}
</style><style>lite-youtube>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}
</style><style>lite-youtube{background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover;cursor:pointer;max-width:720px}lite-youtube:before{content:attr(data-title);display:block;position:absolute;top:0;background-image:linear-gradient(180deg,#000000ab,#0000008a 14%,#00000026 54%,#0000000d 72%,#0000 94%);height:99px;width:100%;font-family:YouTube Noto,Roboto,Arial,Helvetica,sans-serif;color:#eee;text-shadow:0 0 2px rgba(0,0,0,.5);font-size:18px;padding:25px 20px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box}lite-youtube:hover:before{color:#fff}lite-youtube:after{content:"";display:block;padding-bottom:56.25%}lite-youtube>iframe{width:100%;height:100%;position:absolute;top:0;left:0;border:0}lite-youtube>.lty-playbtn{display:block;width:100%;height:100%;background:no-repeat center/68px 48px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z" fill="red"/><path d="M45 24 27 14v20" fill="white"/></svg>');position:absolute;cursor:pointer;z-index:1;filter:grayscale(100%);transition:filter .1s cubic-bezier(0,0,.2,1);border:0}lite-youtube:hover>.lty-playbtn,lite-youtube .lty-playbtn:focus{filter:none}lite-youtube.lyt-activated{cursor:unset}lite-youtube.lyt-activated:before,lite-youtube.lyt-activated>.lty-playbtn{opacity:0;pointer-events:none}.lyt-visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}
</style></head> <body class="bg-white dark:bg-gray-900"> <header class="py-6 border-b border-gray-200 dark:border-gray-700 container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl"> <nav class="container mx-auto px-4"> <div class="flex items-center justify-between"> <div class="text-2xl font-bold dark:text-gray-300"> <a href="/">Laurent Kempé</a> </div> <!-- Mobile menu button and utilities --> <div class="flex items-center gap-4 md:hidden text-gray-600 dark:text-gray-300"> <div class="flex items-center gap-4"> <a href="/atom.xml" aria-label="RSS Feed" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path> </svg> </a> <theme-toggle> <button title="Dark/Light mode" aria-pressed="false" aria-label="Toggle dark mode" class="focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"></button> </theme-toggle> <script type="module">const i=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
    <circle cx="12" cy="12" r="5"/>
    <g stroke="currentColor" stroke-width="2" stroke-linecap="round">
      <line x1="12" y1="1" x2="12" y2="3"/>
      <line x1="12" y1="21" x2="12" y2="23"/>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
      <line x1="1" y1="12" x2="3" y2="12"/>
      <line x1="21" y1="12" x2="23" y2="12"/>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
    </g>
  </svg>`,n=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
    <path d="M17.293 13.293a8 8 0 11-10.586-10.586 8.003 8.003 0 0010.586 10.586z"/>
  </svg>`;class r extends HTMLElement{STORAGE_KEY="theme-preference";_darkTheme=!1;button;constructor(){if(super(),this.button=this.querySelector("button"),!this.button){console.error("Theme toggle button not found");return}const e=localStorage.getItem(this.STORAGE_KEY);e?this.darkTheme=e==="dark":this.darkTheme=window.matchMedia("(prefers-color-scheme: dark)").matches,this.button.addEventListener("click",this.toggleTheme.bind(this)),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{localStorage.getItem(this.STORAGE_KEY)||(this.darkTheme=t.matches)})}get darkTheme(){return this._darkTheme}set darkTheme(e){if(this._darkTheme=e,document.documentElement.classList.toggle("dark",e),this.button){this.button.innerHTML=e?i:n,this.button.setAttribute("aria-label",e?"Switch to light theme":"Switch to dark theme"),this.button.setAttribute("aria-pressed",e.toString());const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("class","sr-only"),t.textContent=e?"Dark theme enabled":"Light theme enabled",this.appendChild(t),setTimeout(()=>{t.parentNode===this&&this.removeChild(t)},1e3)}}toggleTheme(){this.darkTheme=!this.darkTheme,localStorage.setItem(this.STORAGE_KEY,this.darkTheme?"dark":"light")}}customElements.define("theme-toggle",r);</script> </div> <button id="mobile-menu-button" aria-expanded="false" aria-controls="mobile-menu" aria-label="Toggle menu" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"> <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </button> </div> <!-- Desktop menu --> <div class="hidden md:flex md:items-center md:gap-6 text-gray-600 dark:text-gray-300"> <a href="/" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 ">Home</a> <a href="/blog/1" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 ">Blog</a> <a href="/speaking" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 ">Speaking</a> <a href="/about-laurent-kempe" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 ">About</a> <a href="/all-archives" aria-label="Archives" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 "> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"></path> </svg> </a> <a href="/all-tags" aria-label="Tags" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 "> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path> <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path> </svg> </a> <a href="/atom.xml" aria-label="RSS Feed" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path> </svg> </a> <theme-toggle> <button title="Dark/Light mode" aria-pressed="false" aria-label="Toggle dark mode" class="focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1"></button> </theme-toggle>  </div> </div> <!-- Mobile menu panel --> <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4" role="menu" aria-labelledby="mobile-menu-button"> <div class="flex flex-col gap-4 text-gray-600 dark:text-gray-300"> <a href="/" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 " role="menuitem">Home</a> <a href="/blog/1" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 " role="menuitem">Blog</a> <a href="/speaking" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 " role="menuitem">Speaking</a> <a href="/about-laurent-kempe" class="hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 " role="menuitem">About</a> <a href="/all-archives" aria-label="Archives" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 "> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"></path> </svg> </a> <a href="/all-tags" aria-label="Tags" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 rounded-md p-1 "> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path> <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path> </svg> </a> </div> </div> </nav> </header> <script type="module">const i=document.getElementById("mobile-menu-button"),o=document.getElementById("mobile-menu");let n=[],s,u;function c(){o?.classList.remove("hidden"),i?.setAttribute("aria-expanded","true"),n=o?.querySelectorAll('a[href], button, textarea, input[type="text"], input[type="radio"], input[type="checkbox"], select'),n.length&&(s=n[0],u=n[n.length-1],setTimeout(()=>{s.focus()},50)),l("Menu opened")}function d(){o?.classList.add("hidden"),i?.setAttribute("aria-expanded","false"),i?.focus(),l("Menu closed")}function l(e){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("class","sr-only"),t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentNode===document.body&&document.body.removeChild(t)},1e3)}i?.addEventListener("click",()=>{o?.classList.contains("hidden")===!1?d():c()});document.addEventListener("keydown",e=>{if(!o?.classList.contains("hidden")){if(e.key==="Escape"){d();return}e.key==="Tab"&&(e.shiftKey&&document.activeElement===s?(e.preventDefault(),u.focus()):!e.shiftKey&&document.activeElement===u&&(e.preventDefault(),s.focus()))}});</script> <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">  <p data-astro-cid-5grsw2hi><em data-astro-cid-5grsw2hi></em></p>  <div class="relative pt-1 cover-image-container" data-astro-cid-5grsw2hi> <img src="https://live.staticflickr.com/4410/36576108926_d296e0fa6b_h.jpg" alt="Atimaono, Tahiti, France" data-astro-cid-5grsw2hi="true" loading="lazy" decoding="async" fetchpriority="auto" width="1600" height="1067" class="w-full"> <div class="absolute text-white top-1/3 left-1/3 transform -translate-x-1/4 -translate-y-1/4" data-astro-cid-5grsw2hi> <p class="text-2xl sm:text-3xl md:text-5xl font-extrabold drop-shadow-[0_4px_3px_rgb(0,0,0,0.5)] dark:drop-shadow-[0_4px_3px_rgb(255,255,255,0.5)]" data-astro-cid-5grsw2hi>WPF and IOC on .NET Core 3.0</p> <p class="py-2 text-sm sm:text-base" data-astro-cid-5grsw2hi>Apr 18, 2019</p> </div> <p class="absolute text-sm sm:text-xs text-white bottom-5 right-5 hidden md:block" data-astro-cid-5grsw2hi>Atimaono, Tahiti, France</p> <div class="absolute bottom-5 left-5 hidden md:block" data-astro-cid-5grsw2hi> <div class="flex gap-1 flex-wrap"><a href="/tags/dotnet-core" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">.NET Core</a><a href="/tags/wpf" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">WPF</a></div> </div> </div> <p class="text-sm text-center py-2 text-gray-600 dark:text-gray-400 block md:hidden" data-astro-cid-5grsw2hi>Atimaono, Tahiti, France</p><div class="py-2 block md:hidden" data-astro-cid-5grsw2hi> <div class="flex gap-1 flex-wrap"><a href="/tags/dotnet-core" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">.NET Core</a><a href="/tags/wpf" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">WPF</a></div> </div><div class="py-4" data-astro-cid-5grsw2hi>  <article class="prose prose-lg max-w-none dark:prose-invert
                    prose-h1:font-bold prose-h1:text-4xl md:prose-h1:text-4xl prose-h1:text-xl prose-h1:mb-4
                    prose-a:text-blue-600 dark:prose-a:text-blue-400 prose-a:no-underline
                    prose-p:text-justify prose-img:rounded-xl"> <p>At work, we are planning to migrate our WPF application from .NET Framework 4.7 to <a href="https://docs.microsoft.com/en-us/dotnet/core/whats-new/dotnet-core-3-0">.NET Core 3.0</a>. The main reason for doing so is that it was always a big pain to organize the updates of the .NET Framework on our customer machines. So being able to bundle .NET Core with our application is a big plus for us. Then, for sure, we are looking for the performance improvements brought by .NET Core and finally the new capabilities brought by the fast pace of innovation of .NET Core.</p>

<p>This is a great opportunity for us to see and renew a part of the libraries we depend on.</p>
<p>In the current version of our application, we are using <a href="https://github.com/structuremap/structuremap">StructureMap</a> as our <a href="https://en.wikipedia.org/wiki/Inversion_of_control">IOC container</a>. As you might have read <a href="https://jeremydmiller.com/2018/01/29/sunsetting-structuremap/">StructureMap has been sunsetted</a> and replaced by <a href="https://jasperfx.github.io/lamar/">Lamar</a>.</p>
<p>We could have gone to Lamar as it maintains API compatibility with SturtureMap. I just did not want to bring the dependency to Roslyn, but it seems that it was changed in <a href="https://jeremydmiller.com/2019/03/29/lamar-v3-is-released-faster-smaller-quicker-cold-starts-internal-type-friendly/">Lamar 3.0</a>. So, we surely will consider it.</p>
<p>As a first try, I would like to have a look at the IOC container brought by the ASP.NET team; <a href="https://www.nuget.org/packages/Microsoft.Extensions.DependencyInjection/3.0.0-preview4.19216.2">Microsoft Extensions DependencyInjection</a>. Even if it was brought by the ASP.NET team it doesn’t mean at all that it cannot be used outside of ASP.NET!
It is marked as Fast by <a href="https://twitter.com/danielpalme">Daniel Palme</a> in his post ‘<a href="http://www.palmmedia.de/blog/2011/8/30/ioc-container-benchmark-performance-comparison">IoC Container Benchmark - Performance comparison</a>’, so it is a good candidate.</p>
<p>The goal of this post is to see how we could use Microsoft Extensions DependencyInjection in a .NET Core 3.0 with WPF. We will start really easily by creating a new WPF application with the .NET Core CLI.</p>
<h1 id="project-creation">Project creation</h1>
<p>We create our project from the command line.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">❯</span><span style="color:#9ECBFF"> mkdir</span><span style="color:#9ECBFF"> WpfIoc</span></span>
<span class="line"><span style="color:#B392F0">❯</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> WpfIoc</span></span>
<span class="line"><span style="color:#B392F0">❯</span><span style="color:#9ECBFF"> dotnet.exe</span><span style="color:#79B8FF"> --version</span></span>
<span class="line"><span style="color:#B392F0">3.0.100-preview4-011223</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">❯</span><span style="color:#9ECBFF"> dotnet</span><span style="color:#9ECBFF"> new</span><span style="color:#9ECBFF"> wpf</span></span>
<span class="line"><span style="color:#B392F0">The</span><span style="color:#9ECBFF"> template</span><span style="color:#9ECBFF"> &quot;WPF Application&quot;</span><span style="color:#9ECBFF"> was</span><span style="color:#9ECBFF"> created</span><span style="color:#9ECBFF"> successfully.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">Processing</span><span style="color:#9ECBFF"> post-creation</span><span style="color:#9ECBFF"> actions...</span></span>
<span class="line"><span style="color:#B392F0">Running</span><span style="color:#9ECBFF"> &#39;dotnet restore&#39;</span><span style="color:#9ECBFF"> on</span><span style="color:#9ECBFF"> C:</span><span style="color:#79B8FF">\U</span><span style="color:#9ECBFF">sers</span><span style="color:#79B8FF">\l</span><span style="color:#9ECBFF">aure</span><span style="color:#79B8FF">\p</span><span style="color:#9ECBFF">rojects</span><span style="color:#79B8FF">\W</span><span style="color:#9ECBFF">pfIoc</span><span style="color:#79B8FF">\W</span><span style="color:#9ECBFF">pfIoc.csproj...</span></span>
<span class="line"><span style="color:#B392F0">  Restore</span><span style="color:#9ECBFF"> completed</span><span style="color:#9ECBFF"> in</span><span style="color:#79B8FF"> 90.03</span><span style="color:#9ECBFF"> ms</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> C:</span><span style="color:#79B8FF">\U</span><span style="color:#9ECBFF">sers</span><span style="color:#79B8FF">\l</span><span style="color:#9ECBFF">aure</span><span style="color:#79B8FF">\p</span><span style="color:#9ECBFF">rojects</span><span style="color:#79B8FF">\W</span><span style="color:#9ECBFF">pfIoc</span><span style="color:#79B8FF">\W</span><span style="color:#9ECBFF">pfIoc.csproj.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">Restore</span><span style="color:#9ECBFF"> succeeded.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">❯</span><span style="color:#9ECBFF"> dotnet</span><span style="color:#9ECBFF"> build</span></span>
<span class="line"><span style="color:#B392F0">Microsoft</span><span style="color:#E1E4E8"> (R) Build Engine version 16.1.54-preview+gd004974104 </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> .NET Core</span></span>
<span class="line"><span style="color:#B392F0">Copyright</span><span style="color:#E1E4E8"> (C) Microsoft Corporation. All rights reserved.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  Restore</span><span style="color:#9ECBFF"> completed</span><span style="color:#9ECBFF"> in</span><span style="color:#79B8FF"> 19.92</span><span style="color:#9ECBFF"> ms</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> C:</span><span style="color:#79B8FF">\U</span><span style="color:#9ECBFF">sers</span><span style="color:#79B8FF">\l</span><span style="color:#9ECBFF">aure</span><span style="color:#79B8FF">\p</span><span style="color:#9ECBFF">rojects</span><span style="color:#79B8FF">\W</span><span style="color:#9ECBFF">pfIoc</span><span style="color:#79B8FF">\W</span><span style="color:#9ECBFF">pfIoc.csproj.</span></span>
<span class="line"><span style="color:#B392F0">C:\Program</span><span style="color:#9ECBFF"> Files</span><span style="color:#79B8FF">\d</span><span style="color:#9ECBFF">otnet</span><span style="color:#79B8FF">\s</span><span style="color:#9ECBFF">dk</span><span style="color:#79B8FF">\3</span><span style="color:#9ECBFF">.0.100-preview4-011223</span><span style="color:#79B8FF">\S</span><span style="color:#9ECBFF">dks</span><span style="color:#79B8FF">\M</span><span style="color:#9ECBFF">icrosoft.NET.Sdk</span><span style="color:#79B8FF">\t</span><span style="color:#9ECBFF">argets</span><span style="color:#79B8FF">\M</span><span style="color:#9ECBFF">icrosoft.NET.RuntimeIdentifierInference.targets</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">151,5</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF"> message</span><span style="color:#9ECBFF"> NETSDK1057:</span><span style="color:#9ECBFF"> You</span><span style="color:#9ECBFF"> are</span><span style="color:#9ECBFF"> using</span><span style="color:#9ECBFF"> a</span><span style="color:#9ECBFF"> preview</span><span style="color:#9ECBFF"> version</span><span style="color:#9ECBFF"> of</span><span style="color:#9ECBFF"> .NET</span><span style="color:#9ECBFF"> Core.</span><span style="color:#9ECBFF"> See:</span><span style="color:#9ECBFF"> https://aka.ms/dotnet-core-preview</span><span style="color:#E1E4E8"> [C:</span><span style="color:#79B8FF">\U</span><span style="color:#E1E4E8">sers</span><span style="color:#79B8FF">\l</span><span style="color:#E1E4E8">aure</span><span style="color:#79B8FF">\p</span><span style="color:#E1E4E8">rojects</span><span style="color:#79B8FF">\W</span><span style="color:#E1E4E8">pfIoc</span><span style="color:#79B8FF">\W</span><span style="color:#E1E4E8">pfIoc.csproj]</span></span>
<span class="line"><span style="color:#B392F0">  WpfIoc</span><span style="color:#E1E4E8"> -</span><span style="color:#F97583">&gt;</span><span style="color:#9ECBFF"> C:</span><span style="color:#79B8FF">\U</span><span style="color:#9ECBFF">sers</span><span style="color:#79B8FF">\l</span><span style="color:#9ECBFF">aure</span><span style="color:#79B8FF">\p</span><span style="color:#9ECBFF">rojects</span><span style="color:#79B8FF">\W</span><span style="color:#9ECBFF">pfIoc</span><span style="color:#79B8FF">\b</span><span style="color:#9ECBFF">in</span><span style="color:#79B8FF">\D</span><span style="color:#9ECBFF">ebug</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">etcoreapp3.0</span><span style="color:#79B8FF">\W</span><span style="color:#9ECBFF">pfIoc.dll</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">Build</span><span style="color:#9ECBFF"> succeeded.</span></span>
<span class="line"><span style="color:#B392F0">    0</span><span style="color:#9ECBFF"> Warning</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">s</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">    0</span><span style="color:#9ECBFF"> Error</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">s</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">Time</span><span style="color:#9ECBFF"> Elapsed</span><span style="color:#9ECBFF"> 00:00:01.63</span></span></code></pre>
<p>What we want to achieve is to bootstrap the application and inject in the constructor of our MainWindow a service which will be called to display some text on the main window of the application.</p>
<h1 id="code">Code</h1>
<p>First, we need to add the reference to the <em>Microsoft Extensions DependencyInjection</em>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">&lt;</span><span style="color:#85E89D">Project</span><span style="color:#B392F0"> Sdk</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Microsoft.NET.Sdk.WindowsDesktop&quot;</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &lt;</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">OutputType</span><span style="color:#E1E4E8">&gt;WinExe&lt;/</span><span style="color:#85E89D">OutputType</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">TargetFramework</span><span style="color:#E1E4E8">&gt;netcoreapp3.0&lt;/</span><span style="color:#85E89D">TargetFramework</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">UseWPF</span><span style="color:#E1E4E8">&gt;true&lt;/</span><span style="color:#85E89D">UseWPF</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">  &lt;/</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  &lt;</span><span style="color:#85E89D">ItemGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">PackageReference</span><span style="color:#B392F0"> Include</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Microsoft.Extensions.DependencyInjection&quot;</span><span style="color:#B392F0"> Version</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;3.0.0-preview4.19216.2&quot;</span><span style="color:#E1E4E8"> /&gt;  </span></span>
<span class="line"><span style="color:#E1E4E8">  &lt;/</span><span style="color:#85E89D">ItemGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&lt;/</span><span style="color:#85E89D">Project</span><span style="color:#E1E4E8">&gt;</span></span></code></pre>
<p>Then we create an interface <em>ITextService</em> which will be injected by the container into the MainWindow class.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#F97583">public</span><span style="color:#F97583"> interface</span><span style="color:#B392F0"> ITextService</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#F97583">    string</span><span style="color:#B392F0"> GetText</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>In fact, it is a concrete implementation of that interface which will be injected <em>TextService</em>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> TextService</span><span style="color:#E1E4E8"> : </span><span style="color:#B392F0">ITextService</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#F97583">    private</span><span style="color:#F97583"> string</span><span style="color:#B392F0"> _text</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    public</span><span style="color:#B392F0"> TextService</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">string</span><span style="color:#B392F0"> text</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#E1E4E8">        _text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> text;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    public</span><span style="color:#F97583"> string</span><span style="color:#B392F0"> GetText</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> _text;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>Then we need to configure our IOC container.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#E1E4E8">services.</span><span style="color:#B392F0">AddSingleton</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">ITextService</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#B392F0">provider</span><span style="color:#F97583"> =&gt;</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> TextService</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;Hi WPF .NET Core 3.0!&quot;</span><span style="color:#E1E4E8">));</span></span></code></pre>
<p>So this also means that we need to have our IOC container creating our WPF MainWindow, no problem it is just another normal C# class.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#E1E4E8">services.</span><span style="color:#B392F0">AddSingleton</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">MainWindow</span><span style="color:#E1E4E8">&gt;();</span></span></code></pre>
<p>Next piece which we need to put in place is the one linking all the other pieces together; the IOC container! That’s quite easy we just need to extend the App class to create <em>ServiceCollection</em> add the dependencies we want the IOC container to manage and then to call <em>BuildServiceProvider</em>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#F97583">public</span><span style="color:#B392F0"> App</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#F97583">    var</span><span style="color:#B392F0"> serviceCollection</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> ServiceCollection</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#B392F0">    ConfigureServices</span><span style="color:#E1E4E8">(serviceCollection);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    _serviceProvider </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> serviceCollection.</span><span style="color:#B392F0">BuildServiceProvider</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">private</span><span style="color:#F97583"> void</span><span style="color:#B392F0"> ConfigureServices</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">IServiceCollection</span><span style="color:#B392F0"> services</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#E1E4E8">    services.</span><span style="color:#B392F0">AddSingleton</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">ITextService</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#B392F0">provider</span><span style="color:#F97583"> =&gt;</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> TextService</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;Hi WPF .NET Core 3.0!&quot;</span><span style="color:#E1E4E8">));</span></span>
<span class="line"><span style="color:#E1E4E8">    services.</span><span style="color:#B392F0">AddSingleton</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">MainWindow</span><span style="color:#E1E4E8">&gt;();</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>Then, on the <em>App_OnStartup</em> we are using the ServiceProvider to get an instance of <em>MainWindow</em> which would get the <em>ITextService</em> injected in its constructor.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#F97583">private</span><span style="color:#F97583"> void</span><span style="color:#B392F0"> App_OnStartup</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">object</span><span style="color:#B392F0"> sender</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">StartupEventArgs</span><span style="color:#B392F0"> e</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#F97583">    var</span><span style="color:#B392F0"> mainWindow</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> _serviceProvider.</span><span style="color:#B392F0">GetService</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">MainWindow</span><span style="color:#E1E4E8">&gt;();</span></span>
<span class="line"><span style="color:#E1E4E8">    mainWindow.</span><span style="color:#B392F0">Show</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>We also modified <em>App.xaml</em> to call <em>App_OnStartup</em>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">&lt;</span><span style="color:#85E89D">Application</span><span style="color:#B392F0"> x:Class</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;wpfioc.App&quot;</span></span>
<span class="line"><span style="color:#B392F0">             xmlns</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></span>
<span class="line"><span style="color:#B392F0">             xmlns:x</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></span>
<span class="line"><span style="color:#B392F0">             xmlns:local</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;clr-namespace:wpfioc&quot;</span></span>
<span class="line"><span style="color:#B392F0">             Startup</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;App_OnStartup&quot;</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">Application.Resources</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">Application.Resources</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">&lt;/</span><span style="color:#85E89D">Application</span><span style="color:#E1E4E8">&gt;</span></span></code></pre>
<p>Finally, we modify the XAML of the MainWindow to display some text in a Label.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">&lt;</span><span style="color:#85E89D">Window</span><span style="color:#B392F0"> x:Class</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;WpfIoc.MainWindow&quot;</span></span>
<span class="line"><span style="color:#B392F0">        xmlns</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></span>
<span class="line"><span style="color:#B392F0">        xmlns:x</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></span>
<span class="line"><span style="color:#B392F0">        xmlns:d</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span></span>
<span class="line"><span style="color:#B392F0">        xmlns:mc</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span></span>
<span class="line"><span style="color:#B392F0">        xmlns:local</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;clr-namespace:WpfIoc&quot;</span></span>
<span class="line"><span style="color:#B392F0">        mc:Ignorable</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;d&quot;</span></span>
<span class="line"><span style="color:#B392F0">        Title</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;MainWindow&quot;</span><span style="color:#B392F0"> Height</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;450&quot;</span><span style="color:#B392F0"> Width</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;800&quot;</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">Grid</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">Grid.RowDefinitions</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            &lt;</span><span style="color:#85E89D">RowDefinition</span><span style="color:#B392F0"> Height</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;9*&quot;</span><span style="color:#E1E4E8"> /&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            &lt;</span><span style="color:#85E89D">RowDefinition</span><span style="color:#B392F0"> Height</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;1*&quot;</span><span style="color:#E1E4E8"> /&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;/</span><span style="color:#85E89D">Grid.RowDefinitions</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">Label</span><span style="color:#B392F0"> Name</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Label&quot;</span><span style="color:#B392F0"> Content</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Hello .NET Core!&quot;</span><span style="color:#B392F0"> HorizontalAlignment</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Center&quot;</span><span style="color:#B392F0"> VerticalAlignment</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Center&quot;</span><span style="color:#B392F0"> FontSize</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;40&quot;</span><span style="color:#E1E4E8"> /&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">Grid</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">&lt;/</span><span style="color:#85E89D">Window</span><span style="color:#E1E4E8">&gt;</span></span></code></pre>
<p>And we inject through the constructor, the <em>ITextService</em> interface which is used to set the Label text.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="csharp"><code><span class="line"><span style="color:#F97583">    public</span><span style="color:#F97583"> partial</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> MainWindow</span><span style="color:#E1E4E8"> : </span><span style="color:#B392F0">Window</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#F97583">        public</span><span style="color:#B392F0"> MainWindow</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">ITextService</span><span style="color:#B392F0"> textService</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#B392F0">            InitializeComponent</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            Label.Content </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> textService.</span><span style="color:#B392F0">GetText</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span></code></pre>
<h1 id="result">Result</h1>
<p>We can run the application and see that <em>TextService</em> is called and the WPF application correctly displays the text.</p>
<p><img src="https://live.staticflickr.com/65535/40675205763_ab0cd3c28b_o.png%22" alt="WPF IOC"/></p>
<p>You can get all the code on GitHub</p>
<div class="not-prose my-3"> <a class="block max-w-[600px] p-4 rounded-lg border border-gray-300 bg-white transition-all duration-200 ease-in-out hover:bg-gray-100 text-black no-underline" href="https://github.com/laurentkempe/WpfIoc" target="_blank" style="color: inherit; text-decoration: none;"> <div class="flex items-start"> <svg class="w-8 h-8 text-gray-500" viewBox="0 0 16 16" fill="currentColor"> <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path> </svg> <div class="ml-3 flex-grow"> <p class="text-[1rem] font-bold text-blue-600 m-0"> <span>laurentkempe/</span><b>WpfIoc</b> </p> <p class="text-[0.85rem] my-1 text-gray-700"> .NET Core 3.0 Wpf application using Ioc </p> <div class="flex items-center gap-2 text-gray-600 text-[0.85rem]"> <span class="flex items-center gap-1"> <span class="w-3 h-3 bg-green-500 rounded-full inline-block"></span> <span>C#</span> </span> <span class="flex items-center gap-1"> <svg class="w-4 h-4" viewBox="0 0 16 16" fill="currentColor"> <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path> </svg> <span>13</span> </span> <span class="flex items-center gap-1"> <svg class="w-4 h-4" viewBox="0 0 16 16" fill="currentColor"> <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path> </svg> <span>6</span> </span> </div> </div> <img class="w-18 h-18 rounded-full float-right ml-4 mb-4 mt-2.5 sm:ml-4 sm:float-none sm:mx-auto" src="https://avatars.githubusercontent.com/u/272612?v=4" alt="laurentkempe avatar"> </div> </a> </div> </article>  </div>  <div class="giscus-container mt-8 pt-8 border-t border-gray-200 dark:border-gray-700" data-astro-cid-qdzwzgpn> <div id="giscus-comments" data-astro-cid-qdzwzgpn></div> </div> <script>
  (function() {
    const STORAGE_KEY = "theme-preference";
    
    // Function to get current theme based on ThemeToggle logic
    function getCurrentTheme() {
      const savedTheme = localStorage.getItem(STORAGE_KEY);
      if (savedTheme) {
        return savedTheme === "dark" ? "dark" : "light";
      } else {
        return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
      }
    }
    
    // Function to get giscus theme name
    function getGiscusTheme(isDark) {
      return isDark ? "dark" : "light";
    }
    
    // Function to send theme change message to giscus iframe
    function updateGiscusTheme(theme) {
      const iframe = document.querySelector('iframe.giscus-frame');
      if (iframe) {
        iframe.contentWindow.postMessage({
          giscus: {
            setConfig: {
              theme: getGiscusTheme(theme === "dark")
            }
          }
        }, 'https://giscus.app');
      }
    }
    
    // Initialize giscus with correct theme
    const initialTheme = getCurrentTheme();
    const script = document.createElement('script');
    script.src = 'https://giscus.app/client.js';
    script.setAttribute('data-repo', 'laurentkempe/myblog-comments');
    script.setAttribute('data-repo-id', 'R_kgDOPHtNGA');
    script.setAttribute('data-category', 'General');
    script.setAttribute('data-category-id', 'DIC_kwDOPHtNGM4Csi4o');
    script.setAttribute('data-mapping', 'pathname');
    script.setAttribute('data-strict', '0');
    script.setAttribute('data-reactions-enabled', '1');
    script.setAttribute('data-emit-metadata', '0');
    script.setAttribute('data-input-position', 'bottom');
    script.setAttribute('data-theme', getGiscusTheme(initialTheme === "dark"));
    script.setAttribute('data-lang', 'en');
    script.setAttribute('data-loading', 'lazy');
    script.setAttribute('crossorigin', 'anonymous');
    script.async = true;
    
    const container = document.getElementById('giscus-comments');
    if (container) {
      container.appendChild(script);
    }
    
    // Listen for theme changes
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
          const isDark = document.documentElement.classList.contains('dark');
          updateGiscusTheme(isDark ? "dark" : "light");
        }
      });
    });
    
    // Start observing changes to the document element's class
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['class']
    });
    
    // Also listen for storage changes (in case theme is changed in another tab)
    window.addEventListener('storage', function(e) {
      if (e.key === STORAGE_KEY) {
        const newTheme = e.newValue === "dark" ? "dark" : "light";
        updateGiscusTheme(newTheme);
      }
    });
    
    // Listen for system theme changes when no preference is saved
    window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", function(e) {
      if (!localStorage.getItem(STORAGE_KEY)) {
        updateGiscusTheme(e.matches ? "dark" : "light");
      }
    });
  })();
</script>   </div> <footer class="py-8"> <div class="container mx-auto gap-4 px-4 text-sm text-gray-600 dark:text-gray-300 text-center"> <div>
&copy; 2025 Laurent Kempé. All rights reserved.
</div> <div>
The expressed opinions are my own and do not reflect those of my employer or any third-party entities.
</div> </div> </footer> <script>
            const theme = (() => {
              if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
                return localStorage.getItem("theme");
              }
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                return "dark";
              }
              return "light";
            })();

            if (theme === "light") {
              document.documentElement.classList.remove("dark");
            } else {
              document.documentElement.classList.add("dark");
            }
            window.localStorage.setItem("theme", theme);
        </script> </body> </html> 