<!DOCTYPE html><html lang="en" class="dark"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/ico" href="/favicon.ico"><link rel="stylesheet" href="https://cdn.vidstack.io/player.css"><meta name="generator" content="Astro v5.3.0"><link rel="alternate" type="application/rss+xml" title="Laurent Kempé blog" href="https://new.laurentkempe.com/atom.xml"><title>Laurent Kempé - .NET 7 SDK built-in container support and Ubuntu Chiseled</title><link rel="stylesheet" href="/_astro/_slug_.foPIbkM3.css">
<style>a[data-astro-cid-5grsw2hi]{color:#00539f}.tags[data-astro-cid-5grsw2hi]{display:flex;flex-wrap:wrap}.tag[data-astro-cid-5grsw2hi]{margin:.25em;border:dotted 1px #a1a1a1;border-radius:.5em;padding:.5em 1em;font-size:1.15em;background-color:#f8fcfd}@media (prefers-color-scheme: dark){a[data-astro-cid-5grsw2hi]{color:#7fb3d5}.tag[data-astro-cid-5grsw2hi]{border-color:#5a5a5a;background-color:#2d2d2d}}body,html{margin:0;padding:0;width:100%;overflow-x:hidden}.relative[data-astro-cid-5grsw2hi]{width:100%}.absolute[data-astro-cid-5grsw2hi]{max-width:100%}
</style></head> <body class="bg-white dark:bg-gray-900"> <header class="py-6 border-b border-gray-200 dark:border-gray-700 container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl"> <nav class="container mx-auto px-4"> <div class="flex items-center justify-between"> <div class="text-2xl font-bold dark:text-gray-300"> <a href="/">Laurent Kempé</a> </div> <!-- Mobile menu button and utilities --> <div class="flex items-center gap-4 md:hidden text-gray-600 dark:text-gray-300"> <div class="flex items-center gap-4"> <a href="/atom.xml" title="RSS Feed" class="hover:text-gray-900 dark:hover:text-gray-100"> <title>RSS Feed</title> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path> </svg> </a> <theme-toggle> <button title="Dark/Light mode"></button> </theme-toggle> <script type="module">const i=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="currentColor" viewBox="0 0 24 24">
    <circle cx="12" cy="12" r="5"/>
    <g stroke="currentColor" stroke-width="2" stroke-linecap="round">
      <line x1="12" y1="1" x2="12" y2="3"/>
      <line x1="12" y1="21" x2="12" y2="23"/>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
      <line x1="1" y1="12" x2="3" y2="12"/>
      <line x1="21" y1="12" x2="23" y2="12"/>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
    </g>
  </svg>`,s=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" viewBox="0 0 20 20" fill="currentColor">
    <path d="M17.293 13.293a8 8 0 11-10.586-10.586 8.003 8.003 0 0010.586 10.586z"/>
  </svg>`;class o extends HTMLElement{STORAGE_KEY="theme-preference";_darkTheme=!1;button;constructor(){if(super(),this.button=this.querySelector("button"),!this.button){console.error("Theme toggle button not found");return}const e=localStorage.getItem(this.STORAGE_KEY);e?this.darkTheme=e==="dark":this.darkTheme=window.matchMedia("(prefers-color-scheme: dark)").matches,this.button.addEventListener("click",this.toggleTheme.bind(this)),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{localStorage.getItem(this.STORAGE_KEY)||(this.darkTheme=t.matches)})}get darkTheme(){return this._darkTheme}set darkTheme(e){this._darkTheme=e,document.documentElement.classList.toggle("dark",e),this.button&&(this.button.innerHTML=e?i:s,this.button.setAttribute("aria-label",e?"Switch to light theme":"Switch to dark theme"))}toggleTheme(){this.darkTheme=!this.darkTheme,localStorage.setItem(this.STORAGE_KEY,this.darkTheme?"dark":"light")}}customElements.define("theme-toggle",o);</script> </div> <button id="mobile-menu-button" class="hover:text-gray-900 dark:hover:text-gray-100"> <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </button> </div> <!-- Desktop menu --> <div class="hidden md:flex md:items-center md:gap-6 text-gray-600 dark:text-gray-300"> <a href="/" class="hover:text-gray-900 dark:hover:text-gray-100 ">Home</a> <a href="/blog/1" class="hover:text-gray-900 dark:hover:text-gray-100 ">Blog</a> <a href="/speaking" class="hover:text-gray-900 dark:hover:text-gray-100 ">Speaking</a> <a href="/about-laurent-kempe" class="hover:text-gray-900 dark:hover:text-gray-100 ">About</a> <a href="/all-archives" title="Archives" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 "> <title>Archives</title> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"> <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"></path> </svg> </a> <a href="/all-tags" title="Tags" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 "> <title>Tags</title> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"> <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path> <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path> </svg> </a> <a href="/atom.xml" title="RSS Feed" class="hover:text-gray-900 dark:hover:text-gray-100"> <title>RSS Feed</title> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path> </svg> </a> <theme-toggle> <button title="Dark/Light mode"></button> </theme-toggle>  </div> </div> <!-- Mobile menu panel --> <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4"> <div class="flex flex-col gap-4 text-gray-600 dark:text-gray-300"> <a href="/" class="hover:text-gray-900 dark:hover:text-gray-100 ">Home</a> <a href="/blog/1" class="hover:text-gray-900 dark:hover:text-gray-100 ">Blog</a> <a href="/speaking" class="hover:text-gray-900 dark:hover:text-gray-100 ">Speaking</a> <a href="/about-laurent-kempe" class="hover:text-gray-900 dark:hover:text-gray-100 ">About</a> <a href="/all-archives" title="Archives" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 "> <title>Archives</title> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"> <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"></path> </svg> </a> <a href="/all-tags" title="Tags" class="hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 "> <title>Tags</title> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"> <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path> <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path> </svg> </a> </div> </div> </nav> </header> <script type="module">const e=document.getElementById("mobile-menu-button"),t=document.getElementById("mobile-menu");e?.addEventListener("click",()=>{t?.classList.toggle("hidden")});</script> <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">  <p data-astro-cid-5grsw2hi><em data-astro-cid-5grsw2hi></em></p> <div class="relative pt-1" data-astro-cid-5grsw2hi> <img src="https://live.staticflickr.com/4401/36848984906_a51b695ef2_h.jpg" alt="Moʻorea, Polynésie, France" data-astro-cid-5grsw2hi="true" width="1600" height="1067" loading="lazy" decoding="async" class="w-full"> <div class="absolute text-white top-1/3 left-1/3 transform -translate-x-1/4 -translate-y-1/4" data-astro-cid-5grsw2hi> <p class="text-2xl sm:text-3xl md:text-5xl font-extrabold drop-shadow-[0_4px_3px_rgb(0,0,0,0.5)] dark:drop-shadow-[0_4px_3px_rgb(255,255,255,0.5)]" data-astro-cid-5grsw2hi>.NET 7 SDK built-in container support and Ubuntu Chiseled</p> <p class="py-2 text-sm sm:text-base" data-astro-cid-5grsw2hi>Nov 14, 2022</p> </div> <div class="absolute bottom-5 left-5" data-astro-cid-5grsw2hi> <div class="flex gap-1 flex-wrap"><a href="/tags/asp-net-core" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">ASP.NET Core</a><a href="/tags/docker" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">Docker</a><a href="/tags/ubuntu" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">Ubuntu</a><a href="/tags/dotnet-sdk" class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-300 rounded-full text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">.NET SDK</a></div> </div> <p class="absolute text-sm sm:text-xs text-white bottom-5 right-5" data-astro-cid-5grsw2hi>Moʻorea, Polynésie, France</p> </div> <div class="py-4" data-astro-cid-5grsw2hi>  <article class="prose prose-lg max-w-none dark:prose-invert
                    prose-h1:font-bold prose-h1:text-4xl md:prose-h1:text-4xl prose-h1:text-xl prose-h1:mb-4
                    prose-a:text-blue-600 dark:prose-a:text-blue-400 prose-a:no-underline
                    prose-p:text-justify prose-img:rounded-xl"> <p>End of summer 2022, the .NET team at Microsoft announced two things related to containers: .NET in Chiseled Ubuntu containers and then a week after built-in container support in the .NET 7 SDK. I have talked about both topics on two episodes of the French podcast <a href="https://devdevdev.net/">devdevdev.net</a> by my friend <a href="https://twitter.com/c2iClark">Richard Clark</a>. In this post, I will explain what those are and how to combine them.</p>

<h1 id="net-in-chiseled-ubuntu-containers">.NET in Chiseled Ubuntu containers</h1>
<p>.NET in Chiseled Ubuntu containers are new <strong>small</strong> and <strong>secure containers</strong> offered by Canonical. Those images are <strong>100MB smaller</strong> than the Ubuntu image.</p>
<p>Why does it improve security? Because small images reduce the attack surface. Based on images with only the packages required to run the container, no package manager, no shell, and non-root user.</p>
<p>The idea originates from distroless concept introduced in 2017 by Google. On top of that, it brings the following features: polished tools and trusted packages from platform providers, choice of free or paid support, choice of fast-moving releases or LTS, possibility to customize the images.</p>
<p><img src="/images/standardvsChiseledDotNETimages.png" alt="Standard vs Chiseled .NET Images"/></p>
<p>To take advantage of those new images, in .NET 6 and 7 for Arm64 and x64, you need to use one of the three layers of Chiseled Ubuntu container images.</p>
<ul>
<li>mcr.microsoft.com/dotnet/nightly/runtime-deps:7.0-jammy-chiseled</li>
<li>mcr.microsoft.com/dotnet/nightly/runtime:7.0-jammy-chiseled</li>
<li>mcr.microsoft.com/dotnet/nightly/aspnet:7.0-jammy-chiseled</li>
</ul>
<div class=" bg-blue-100 border-l-4 border-blue-500 text-blue-700 dark:bg-blue-900 dark:border-blue-700 dark:text-blue-300 rounded-lg shadow-md p-2"> <!-- Reduced padding to the container --> <div class="flex flex-col items-start"> <div class="flex-none pt-0 mb-0"> <!-- Reduced margin-bottom --> <svg class="fill-current h-6 w-6 text-blue-500 dark:text-blue-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"> <path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"></path> </svg> </div> <div class="w-full">  <p>Today this is still in preview, and images are served from the nightly repository. Final images will be available before end of this year.</p> </div> </div> </div> <p></p>
<h1 id="built-in-container-support-in-the-net-7-sdk">Built-in container support in the .NET 7 SDK</h1>
<p>You can use Dockerfile to bundle your .NET application in a container. You create a Dockerfile, install the .NET SDK, restore the packages, build the application, and copy the output in the container. It implies quite some steps and is not easy to do right.</p>
<p>Today, .NET 7 SDK supports <strong>container images</strong> as a new output type through a simple <strong>dotnet publish</strong>. This was already the case on other platforms Ko for Go, Jib for Java, and even in .NET with projects like konet.</p>
<p>It requires only adding one NuGet package reference to the project file:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">&lt;</span><span style="color:#85E89D">PackageReference</span><span style="color:#B392F0"> Include</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Microsoft.NET.Build.Containers&quot;</span><span style="color:#B392F0"> Version</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;0.2.7&quot;</span><span style="color:#E1E4E8">/&gt;</span></span></code></pre>
<div class=" bg-blue-100 border-l-4 border-blue-500 text-blue-700 dark:bg-blue-900 dark:border-blue-700 dark:text-blue-300 rounded-lg shadow-md p-2"> <!-- Reduced padding to the container --> <div class="flex flex-col items-start"> <div class="flex-none pt-0 mb-0"> <!-- Reduced margin-bottom --> <svg class="fill-current h-6 w-6 text-blue-500 dark:text-blue-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"> <path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"></path> </svg> </div> <div class="w-full">  <p>In the future it will be part of the SDK, so you will not need to add this NuGet package reference.</p> </div> </div> </div> <p></p>
<div class=" bg-blue-100 border-l-4 border-blue-500 text-blue-700 dark:bg-blue-900 dark:border-blue-700 dark:text-blue-300 rounded-lg shadow-md p-2"> <!-- Reduced padding to the container --> <div class="flex flex-col items-start"> <div class="flex-none pt-0 mb-0"> <!-- Reduced margin-bottom --> <svg class="fill-current h-6 w-6 text-blue-500 dark:text-blue-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"> <path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"></path> </svg> </div> <div class="w-full">  <p>Currently, only Linux containers are supported.</p> </div> </div> </div> <p></p>
<p>Then you can run the following command:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8"> ❯  dotnet publish </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">os linux </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">arch x64 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">p:PublishProfile</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">DefaultContainer </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">c Release</span></span>
<span class="line"><span style="color:#E1E4E8">MSBuild version </span><span style="color:#79B8FF">17.4</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#F97583">+</span><span style="color:#E1E4E8">18d5aef85 </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> .NET</span></span>
<span class="line"><span style="color:#E1E4E8">  Determining projects to restore...</span></span>
<span class="line"><span style="color:#E1E4E8">  All projects are up</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">to</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">date </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> restore.</span></span>
<span class="line"><span style="color:#E1E4E8">  WebApp </span><span style="color:#F97583">-&gt;</span><span style="color:#E1E4E8"> C:\Users\laure\projects\dotnet\7rtm\ParsableStatic\WebApp\bin\Release\net7.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">\linux</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">x64\WebApp.dll</span></span>
<span class="line"><span style="color:#E1E4E8">  WebApp </span><span style="color:#F97583">-&gt;</span><span style="color:#E1E4E8"> C:\Users\laure\projects\dotnet\7rtm\ParsableStatic\WebApp\bin\Release\net7.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">\linux</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">x64\publish\</span></span>
<span class="line"><span style="color:#9ECBFF">  &#39;WebApp&#39;</span><span style="color:#E1E4E8"> was not a valid container image name</span><span style="color:#F97583">,</span><span style="color:#E1E4E8"> it was normalized to webapp</span></span>
<span class="line"><span style="color:#E1E4E8">  Building image </span><span style="color:#9ECBFF">&#39;webapp&#39;</span><span style="color:#E1E4E8"> with tags </span><span style="color:#79B8FF">1.0</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8"> on top of base image </span><span style="color:#79B8FF">mcr.microsoft.com</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">aspnet:</span><span style="color:#79B8FF">7.0</span></span>
<span class="line"><span style="color:#E1E4E8">  Pushed container </span><span style="color:#9ECBFF">&#39;webapp:1.0.0&#39;</span><span style="color:#E1E4E8"> to Docker daemon</span></span></code></pre>
<p>The image created is <strong>216MB</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8"> ❯  docker image list</span></span>
<span class="line"><span style="color:#E1E4E8">REPOSITORY   TAG       IMAGE ID       CREATED         SIZE</span></span>
<span class="line"><span style="color:#E1E4E8">webapp       </span><span style="color:#79B8FF">1.0</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     e2d2de6a8878   </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8"> seconds ago   </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span></code></pre>
<p>You can control many of the properties of the image created, like the image name and tags, through MSBuild properties. See, <a href="https://learn.microsoft.com/en-us/dotnet/core/docker/publish-as-container#configure-container-image">Configure container image</a>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;dotnet-webapp-image&lt;/</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;1.1.0&lt;/</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span></code></pre>
<p>After dotnet publish, the image with the new name and version is created</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8"> ❯  docker image list</span></span>
<span class="line"><span style="color:#E1E4E8">REPOSITORY            TAG       IMAGE ID       CREATED          SIZE</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">image   </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     d63f313397aa   </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8"> seconds ago    </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">webapp                </span><span style="color:#79B8FF">1.0</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     e2d2de6a8878   </span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8"> seconds ago   </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span></code></pre>
<h1 id="can-we-combine-the-two">Can we combine the two?</h1>
<p>Sure. We can combine the two and create a .NET application in a Chiseled Ubuntu container using the .NET SDK. It is a great way to create a small and secure container for your .NET application.</p>
<p>We need to add MSBuild property <strong>ContainerBaseImage</strong> to our csproj file to specify the Chiseled Ubuntu base image to use, in this case, <strong>aspnet:7.0-jammy-chiseled</strong>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;dotnet-webapp-chiseled&lt;/</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;1.1.0&lt;/</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerBaseImage</span><span style="color:#E1E4E8">&gt;mcr.microsoft.com/dotnet/nightly/aspnet:7.0-jammy-chiseled&lt;/</span><span style="color:#85E89D">ContainerBaseImage</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">ItemGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">PackageReference</span><span style="color:#B392F0"> Include</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Microsoft.NET.Build.Containers&quot;</span><span style="color:#B392F0"> Version</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;0.2.7&quot;</span><span style="color:#E1E4E8">/&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">ItemGroup</span><span style="color:#E1E4E8">&gt;</span></span></code></pre>
<p>This time the image is <strong>112MB</strong> compared to the 216MB. We <strong>won 104MB</strong> on top of all other advantages from the Chiseled Ubuntu container.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8"> ❯  dotnet publish </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">os linux </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">arch x64 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">p:PublishProfile</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">DefaultContainer </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">c Release</span></span>
<span class="line"><span style="color:#E1E4E8"> ...</span></span>
<span class="line"><span style="color:#E1E4E8"> ❯  docker image list</span></span>
<span class="line"><span style="color:#E1E4E8">REPOSITORY               TAG       IMAGE ID       CREATED              SIZE</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled   </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     a0456f5d4b27   </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8"> seconds ago        </span><span style="color:#79B8FF">112</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">image      </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     d63f313397aa   About a minute ago   </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">webapp                   </span><span style="color:#79B8FF">1.0</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     e2d2de6a8878   </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8"> minutes ago        </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span></code></pre>
<h1 id="can-we-do-better">Can we do better?</h1>
<p>Yes, we can 😉 mixing chiseling and trimming.</p>
<p>We can use the base image <strong>runtime-deps:7.0-jammy-chiseled</strong>, which is 13MB and publish our ASP.NET application as a self-contained and trimmed application.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;dotnet-webapp-chiseled-trimmed&lt;/</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;1.1.0&lt;/</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerBaseImage</span><span style="color:#E1E4E8">&gt;mcr.microsoft.com/dotnet/nightly/runtime-deps:7.0-jammy-chiseled&lt;/</span><span style="color:#85E89D">ContainerBaseImage</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">PublishTrimmed</span><span style="color:#E1E4E8">&gt;true&lt;/</span><span style="color:#85E89D">PublishTrimmed</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">ItemGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">PackageReference</span><span style="color:#B392F0"> Include</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;Microsoft.NET.Build.Containers&quot;</span><span style="color:#B392F0"> Version</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">&quot;0.2.7&quot;</span><span style="color:#E1E4E8">/&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">ItemGroup</span><span style="color:#E1E4E8">&gt;</span></span></code></pre>
<p>We need to add <strong>—self-contained</strong> to the dotnet publish command. Now, the image is <strong>56.5MB</strong> compared to the 112MB, we won 55.5MB.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8"> ❯  dotnet publish </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">os linux </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">arch x64 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">p:PublishProfile</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">DefaultContainer </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">c Release </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">self</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">contained</span></span>
<span class="line"><span style="color:#E1E4E8"> ...</span></span>
<span class="line"><span style="color:#E1E4E8">   Optimizing assemblies </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> size. This </span><span style="color:#F97583">process</span><span style="color:#E1E4E8"> might take a </span><span style="color:#F97583">while</span><span style="color:#E1E4E8">.</span></span>
<span class="line"><span style="color:#E1E4E8"> ...</span></span>
<span class="line"><span style="color:#E1E4E8"> ❯  docker image list</span></span>
<span class="line"><span style="color:#E1E4E8">REPOSITORY                       TAG       IMAGE ID       CREATED          SIZE</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">trimmed   </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     f1ba30048ef8   </span><span style="color:#79B8FF">11</span><span style="color:#E1E4E8"> seconds ago   </span><span style="color:#79B8FF">56.5</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled           </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     a0456f5d4b27   </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8"> minutes ago    </span><span style="color:#79B8FF">112</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">image              </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     d63f313397aa   </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8"> minutes ago    </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">webapp                           </span><span style="color:#79B8FF">1.0</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     e2d2de6a8878   </span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8"> minutes ago    </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span></code></pre>
<h1 id="can-we-do-even-better">Can we do even better?</h1>
<p>Yes, we can by publishing to a single file</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;dotnet-webapp-chiseled-trimmed-singlefile&lt;/</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;1.1.0&lt;/</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerBaseImage</span><span style="color:#E1E4E8">&gt;mcr.microsoft.com/dotnet/nightly/runtime-deps:7.0-jammy-chiseled&lt;/</span><span style="color:#85E89D">ContainerBaseImage</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">PublishTrimmed</span><span style="color:#E1E4E8">&gt;true&lt;/</span><span style="color:#85E89D">PublishTrimmed</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span></code></pre>
<p>We need to add <strong>-p:PublishSingleFile=true</strong> to the dotnet publish command. Now, the image is <strong>48.4MB</strong> compared to the 56.5MB, we won 8.1MB.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8"> ❯  dotnet publish </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">os linux </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">arch x64 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">p:PublishProfile</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">DefaultContainer </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">c Release </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">self</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">contained true </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">p:PublishSingleFile</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">true</span></span>
<span class="line"><span style="color:#E1E4E8">...</span></span>
<span class="line"><span style="color:#E1E4E8"> ❯  docker image list</span></span>
<span class="line"><span style="color:#E1E4E8">REPOSITORY                                  TAG       IMAGE ID       CREATED          SIZE</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">trimmed</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">singlefile   </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     2643c10fa1d9   </span><span style="color:#79B8FF">56</span><span style="color:#E1E4E8"> seconds ago   </span><span style="color:#79B8FF">48.4</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">trimmed              </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     f1ba30048ef8   </span><span style="color:#79B8FF">11</span><span style="color:#E1E4E8"> seconds ago   </span><span style="color:#79B8FF">56.5</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled                      </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     a369967b535a   </span><span style="color:#79B8FF">15</span><span style="color:#E1E4E8"> minutes ago   </span><span style="color:#79B8FF">112</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">image                         </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     d63f313397aa   </span><span style="color:#79B8FF">31</span><span style="color:#E1E4E8"> minutes ago   </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">webapp                                      </span><span style="color:#79B8FF">1.0</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     e2d2de6a8878   </span><span style="color:#79B8FF">32</span><span style="color:#E1E4E8"> minutes ago   </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span></code></pre>
<h1 id="a-tiny-bit-better">A tiny bit better?</h1>
<p>If you don’t need globalization in your application, you can turn on the <a href="https://github.com/dotnet/runtime/blob/main/docs/design/features/globalization-invariant-mode.md">globalization invariant mode</a>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="xml"><code><span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;dotnet-webapp-chiseled-trimmed-singlefile-invariant&lt;/</span><span style="color:#85E89D">ContainerImageName</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;1.1.0&lt;/</span><span style="color:#85E89D">ContainerImageTag</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">ContainerBaseImage</span><span style="color:#E1E4E8">&gt;mcr.microsoft.com/dotnet/nightly/runtime-deps:7.0-jammy-chiseled&lt;/</span><span style="color:#85E89D">ContainerBaseImage</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">InvariantGlobalization</span><span style="color:#E1E4E8">&gt;true&lt;/</span><span style="color:#85E89D">InvariantGlobalization</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#85E89D">PublishTrimmed</span><span style="color:#E1E4E8">&gt;true&lt;/</span><span style="color:#85E89D">PublishTrimmed</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#85E89D">PropertyGroup</span><span style="color:#E1E4E8">&gt;</span></span></code></pre>
<p>Finally, the image is <strong>48.3MB</strong> compared to the 48.4MB. We won 0.1MB.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8"> ❯  dotnet publish </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">os linux </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">arch x64 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">p:PublishProfile</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">DefaultContainer </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">c Release </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">self</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">contained true </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">p:PublishSingleFile</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">true</span></span>
<span class="line"><span style="color:#E1E4E8"> ...</span></span>
<span class="line"><span style="color:#E1E4E8"> ❯  docker image list</span></span>
<span class="line"><span style="color:#E1E4E8">REPOSITORY                                            TAG       IMAGE ID       CREATED          SIZE</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">trimmed</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">singlefile</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">invariant   </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     fd7c4aca6501   </span><span style="color:#79B8FF">19</span><span style="color:#E1E4E8"> seconds ago   </span><span style="color:#79B8FF">48.3</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">trimmed</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">singlefile             </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     2643c10fa1d9   </span><span style="color:#79B8FF">8</span><span style="color:#E1E4E8"> minutes ago    </span><span style="color:#79B8FF">48.4</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">trimmed                        </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     df989eda0f7f   </span><span style="color:#79B8FF">13</span><span style="color:#E1E4E8"> minutes ago   </span><span style="color:#79B8FF">48.4</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled                                </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     a369967b535a   </span><span style="color:#79B8FF">22</span><span style="color:#E1E4E8"> minutes ago   </span><span style="color:#79B8FF">112</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">image                                   </span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     d63f313397aa   </span><span style="color:#79B8FF">38</span><span style="color:#E1E4E8"> minutes ago   </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span>
<span class="line"><span style="color:#E1E4E8">webapp                                                </span><span style="color:#79B8FF">1.0</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">     e2d2de6a8878   </span><span style="color:#79B8FF">39</span><span style="color:#E1E4E8"> minutes ago   </span><span style="color:#79B8FF">216</span><span style="color:#F97583">MB</span></span></code></pre>
<p>I expected better results with this last step. The runtime-deps:6.0-jammy-chiseled <a href="https://github.com/dotnet/dotnet-docker/blob/nightly/src/runtime-deps/6.0/jammy-chiseled/amd64/Dockerfile#L52-L53">removes ICU</a> and sets <code>DOTNET_SYSTEM_GLOBALIZATION_INVARIANT=true</code>. I guess runtime-deps:7.0-jammy-chiseled does the same, but the code is not yet available.</p>
<blockquote class="twitter-tweet" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Hey <a href="https://twitter.com/runfaster2000?ref_src=twsrc%5Etfw">@runfaster2000</a> and <a href="https://twitter.com/ValentinViennot?ref_src=twsrc%5Etfw">@ValentinViennot</a> Great presentation during the <a href="https://twitter.com/hashtag/dotnetConf?src=hash&ref_src=twsrc%5Etfw">#dotnetConf</a> 👍🏼 Any plan to ship another 7.0-jammy-chiseled without ICU?</p>— Laurent Kempé (@laurentkempe) <a href="https://twitter.com/laurentkempe/status/1591729789345599488?ref_src=twsrc%5Etfw">November 13, 2022</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<h1 id="run">Run</h1>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8"> ❯  docker run </span><span style="color:#F97583">--</span><span style="color:#E1E4E8">rm </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">it </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">p </span><span style="color:#79B8FF">8080</span><span style="color:#E1E4E8">:</span><span style="color:#79B8FF">80</span><span style="color:#E1E4E8">  dotnet</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">webapp</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">chiseled</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">trimmed</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">singlefile</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">invariant:</span><span style="color:#79B8FF">1.1</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">0</span></span>
<span class="line"><span style="color:#E1E4E8">info: Microsoft.Hosting.Lifetime[</span><span style="color:#79B8FF">14</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">      Now listening on: http:</span><span style="color:#F97583">//</span><span style="color:#E1E4E8">[::]:</span><span style="color:#79B8FF">80</span></span>
<span class="line"><span style="color:#E1E4E8">info: Microsoft.Hosting.Lifetime[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">      Application started. Press Ctrl</span><span style="color:#F97583">+</span><span style="color:#E1E4E8">C to shut down.</span></span>
<span class="line"><span style="color:#E1E4E8">info: Microsoft.Hosting.Lifetime[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">      Hosting environment: Production</span></span>
<span class="line"><span style="color:#E1E4E8">info: Microsoft.Hosting.Lifetime[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">      Content root path: </span><span style="color:#F97583">/</span><span style="color:#E1E4E8">app</span></span></code></pre>
<p>Then you can browse to <a href="http://localhost:8080/weatherforecast">http://localhost:8080/weatherforecast</a> to see</p>
<p><img src="/images/dotnet-webapp-chiseled-trimmed-singlefile-invariant.png" alt="dotnet-webapp-chiseled-trimmed-singlefile-invariant running"/></p>
<h1 id="conclusion">Conclusion</h1>
<p>Now that .NET 7 RTM shipped, we can leverage those new capabilities. It lets us create small and secure containers for our .NET applications easily.</p>
<p>We went from a first docker image of <strong>216MB</strong> to a final docker image of <strong>48.3MB</strong>. That’s more than a <strong>77% reduction in size</strong>.</p>
<p>I hope you enjoyed this post and learned something new that you want to try out. If you have any questions or comments, please leave them below. Thanks for reading!</p>
<h1 id="code">Code</h1>
<div class="my-5"> <a class="block max-w-[700px] p-8 rounded-lg border border-text/5 bg-text/[0.025] transition-all duration-200 ease-in-out hover:bg-text/[0.12] hover:border-text/10 text-text dark:bg-text/[0.15] dark:border-text/20 dark:hover:bg-text/[0.25] dark:hover:border-text/30 no-underline" href="https://github.com/laurentkempe/ChiseledDocker" target="_blank" style="color: inherit; text-decoration: none;"> <img class="w-20 h-20 rounded-full float-right ml-8 mb-8 mt-2.5" src="https://avatars.githubusercontent.com/u/272612?v=4" alt="laurentkempe avatar"> <p class="text-[1.8rem] tracking-wide m-0"> <span>laurentkempe/</span><b>ChiseledDocker</b> </p> <p class="text-[0.9rem] my-2.5"> .NET 7 SDK built-in container support and Ubuntu Chiseled </p> <div class="flex items-center gap-16"> <div class="flex flex-row gap-2.5 justify-center"> <svg class="w-[1.1rem] h-[1.1rem] mt-1.5 text-text/70 dark:text-text/50" viewBox="0 0 16 16" fill="currentColor"> <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path> </svg> <div class="flex flex-col"> <b class="text-[1.2rem]">1</b> <span class="text-[0.8rem] opacity-70 dark:opacity-50">Stars</span> </div> </div> <div class="flex flex-row gap-2.5 justify-center"> <svg class="w-[1.1rem] h-[1.1rem] mt-1.5 text-text/70 dark:text-text/50" viewBox="0 0 16 16" fill="currentColor"> <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path> </svg> <div class="flex flex-col"> <b class="text-[1.2rem]">0</b> <span class="text-[0.8rem] opacity-70 dark:opacity-50">Forks</span> </div> </div> <div class="flex flex-row gap-2.5 justify-center"> <svg class="w-[1.1rem] h-[1.1rem] mt-1.5 text-text/70 dark:text-text/50" viewBox="0 0 16 16" fill="currentColor"> <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path> <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path> </svg> <div class="flex flex-col"> <b class="text-[1.2rem]">0</b> <span class="text-[0.8rem] opacity-70 dark:opacity-50">Issues</span> </div> </div> </div> </a> </div>
<h1 id="presentation">Presentation</h1>
<h3 id="using-net-with-chiseled-ubuntu-containers">Using .NET with Chiseled Ubuntu Containers</h3>
<blockquote>
<p>Chiseled Ubuntu Containers are new and exciting. You’ll see how easy it is to switch to using them with .NET and what the benefits are. We’ll show using them at your desktop, deploying them to the cloud, and also making an evil hacker fail to compromise an app (that might otherwise succeed).</p>
</blockquote>
<media-player class="ring-media-focus aspect-video w-full overflow-hidden rounded-md bg-slate-950 font-sans text-white data-[focus]:ring-4" title="Laurent Kempé" src="youtube/FLGFzlWF4Gs" crossorigin="true" playsinline clip-start-time="0"> <media-provider> <source src="youtube/FLGFzlWF4Gs"> </media-provider> <!-- Gestures --> <media-gesture class="absolute inset-0 z-0 block h-full w-full" event="pointerup" action="toggle:paused"></media-gesture> <media-gesture class="absolute inset-0 z-0 block h-full w-full" event="dblpointerup" action="toggle:fullscreen"></media-gesture> <media-gesture class="absolute left-0 top-0 z-10 block h-full w-1/5" event="dblpointerup" action="seek:-10"></media-gesture> <media-gesture class="absolute right-0 top-0 z-10 block h-full w-1/5" event="dblpointerup" action="seek:10"></media-gesture> <!-- Captions --> <media-captions class="media-preview:opacity-0 media-controls:bottom-[85px] media-captions:opacity-100 absolute inset-0 bottom-2 z-10 select-none break-words opacity-0 transition-[opacity,bottom] duration-300"></media-captions> <!-- Controls --> <media-controls class="media-controls:opacity-100 absolute inset-0 z-10 flex h-full w-full flex-col bg-gradient-to-t from-black/10 to-transparent opacity-0 transition-opacity"> <div class="pointer-events-none flex-1"></div> <media-controls-group class="flex w-full items-center px-2"> <!-- Time Slider --> <media-time-slider class="group relative mx-[7.5px] inline-flex h-10 w-full cursor-pointer touch-none select-none items-center outline-none"> <media-slider-chapters class="relative flex h-full w-full items-center rounded-[1px]"> <template> <!-- Slider Chapter --> <div class="last-child:mr-0 relative mr-0.5 flex h-full w-full items-center rounded-[1px]" style="contain: layout style"> <!-- Slider Chapter Track --> <div class="ring-media-focus relative z-0 h-[5px] w-full rounded-sm bg-white/30 group-data-[focus]:ring-[3px]"> <div class="bg-media-brand absolute h-full w-[var(--chapter-fill)] rounded-sm will-change-[width]"></div> <div class="absolute z-10 h-full w-[var(--chapter-progress)] rounded-sm bg-white/50 will-change-[width]"></div> </div> </div> </template> </media-slider-chapters> <!-- Slider Thumb --> <div class="absolute left-[var(--slider-fill)] top-1/2 z-20 h-[15px] w-[15px] -translate-x-1/2 -translate-y-1/2 rounded-full border border-[#cacaca] bg-white opacity-0 ring-white/40 transition-opacity will-change-[left] group-data-[active]:opacity-100 group-data-[dragging]:ring-4"></div> <!-- Slider Preview --> <media-slider-preview class="pointer-events-none flex flex-col items-center opacity-0 transition-opacity duration-200 data-[visible]:opacity-100"> <media-slider-thumbnail class="block h-[var(--thumbnail-height)] max-h-[160px] min-h-[80px] w-[var(--thumbnail-width)] min-w-[120px] max-w-[180px] overflow-hidden border border-white bg-black" src="https://files.vidstack.io/sprite-fight/thumbnails.vtt"></media-slider-thumbnail> <div class="mt-1 text-sm" data-part="chapter-title"></div> <media-slider-value class="text-[13px]"></media-slider-value> </media-slider-preview> </media-time-slider> </media-controls-group> <media-controls-group class="-mt-0.5 flex w-full items-center px-2 pb-2"> <!-- Play Button --> <media-tooltip> <media-tooltip-trigger> <media-play-button class="ring-media-focus relative inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="media-paused:block hidden h-8 w-8" type="play"></media-icon> <media-icon class="media-paused:hidden h-8 w-8" type="pause"></media-icon> </media-play-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top start" offset="30"> <span class="media-paused:block hidden">Play</span> <span class="media-paused:hidden">Pause</span> </media-tooltip-content> </media-tooltip> <!-- Mute Button --> <media-tooltip> <media-tooltip-trigger> <media-mute-button class="ring-media-focus group relative -mr-1.5 inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="hidden h-8 w-8 group-data-[state='muted']:block" type="mute"></media-icon> <media-icon class="hidden h-8 w-8 group-data-[state='low']:block" type="volume-low"></media-icon> <media-icon class="hidden h-8 w-8 group-data-[state='high']:block" type="volume-high"></media-icon> </media-mute-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top" offset="30"> <span class="media-muted:hidden">Mute</span> <span class="media-muted:block hidden">Unmute</span> </media-tooltip-content> </media-tooltip> <!-- Volume Slider --> <media-volume-slider class="group relative mx-[7.5px] inline-flex h-10 w-full max-w-[80px] cursor-pointer touch-none select-none items-center outline-none"> <!-- Slider Track --> <div class="ring-media-focus relative z-0 h-[5px] w-full rounded-sm bg-white/30 group-data-[focus]:ring-[3px]"> <div class="bg-media-brand absolute h-full w-[var(--slider-fill)] rounded-sm will-change-[width]"></div> </div> <!-- Slider Thumb --> <div class="absolute left-[var(--slider-fill)] top-1/2 z-20 h-[15px] w-[15px] -translate-x-1/2 -translate-y-1/2 rounded-full border border-[#cacaca] bg-white opacity-0 ring-white/40 transition-opacity will-change-[left] group-data-[active]:opacity-100 group-data-[dragging]:ring-4"></div> <media-slider-preview class="pointer-events-none opacity-0 transition-opacity duration-200 data-[visible]:opacity-100" no-clamp="true" offset="30"> <media-slider-value class="rounded-sm bg-black px-2 py-px text-[13px] font-medium"></media-slider-value> </media-slider-preview> </media-volume-slider> <!-- Time Group --> <div class="ml-1.5 flex items-center text-sm font-medium"> <media-time type="current"></media-time> <div class="mx-1 text-white/80">/</div> <media-time type="duration"></media-time> </div> <span class="inline-block flex-1 overflow-hidden text-ellipsis whitespace-nowrap px-2 text-sm font-medium text-white/70"> <span class="mr-1">|</span> <media-chapter-title></media-chapter-title> </span> <!-- Caption Button --> <media-tooltip> <media-tooltip-trigger> <media-caption-button class="ring-media-focus group relative mr-0.5 inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="media-captions:block hidden h-8 w-8" type="closed-captions-on"></media-icon> <media-icon class="media-captions:hidden h-8 w-8" type="closed-captions"></media-icon> </media-caption-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top" offset="30"> <span class="media-captions:block hidden">Closed-Captions Off</span> <span class="media-captions:hidden">Closed-Captions On</span> </media-tooltip-content> </media-tooltip> <!-- Settings Menu --> <media-menu class="group"> <!-- Settings Menu Button --> <media-tooltip> <media-tooltip-trigger> <media-menu-button class="ring-media-focus relative mr-0.5 inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 aria-hidden:hidden data-[focus]:ring-4"> <media-icon class="h-8 w-8 transform transition-transform duration-200 ease-out group-data-[open]:rotate-90" type="settings"></media-icon> </media-menu-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white group-data-[open]:hidden" placement="top" offset="30">
Settings
</media-tooltip-content> </media-tooltip> <!-- Settings Menu Items --> <media-menu-items class="animate-out fade-out slide-out-to-bottom-2 data-[open]:animate-in data-[open]:fade-in data-[open]:slide-in-from-bottom-4 flex h-[var(--menu-height)] max-h-[400px] min-w-[260px] flex-col overflow-y-auto overscroll-y-contain rounded-md border border-white/10 bg-black/95 p-2.5 font-sans text-[15px] font-medium outline-none backdrop-blur-sm transition-[height] duration-300 will-change-[height] data-[resizing]:overflow-hidden" offset="30" placement="top end"> <!-- Caption Submenu --> <media-menu> <!-- Caption Submenu Button --> <media-menu-button class="ring-media-focus parent left-0 z-10 flex w-full cursor-pointer select-none items-center justify-start rounded-sm bg-black/60 p-2.5 outline-none ring-inset aria-disabled:hidden aria-hidden:hidden data-[open]:sticky data-[open]:-top-2.5 data-[hocus]:bg-white/10 data-[focus]:ring-[3px]"> <!-- Close Icon --> <media-icon class="parent-data-[open]:block -ml-0.5 mr-1.5 hidden h-[18px] w-[18px]" type="chevron-left"></media-icon> <!-- Icon --> <media-icon class="parent-data-[open]:hidden mr-1.5 h-5 w-5" type="closed-captions"></media-icon> <!-- Label --> <span>Captions</span> <!-- Hint --> <span class="ml-auto text-sm text-white/50" data-part="hint"></span> <!-- Open Icon --> <media-icon class="parent-data-[open]:hidden ml-0.5 h-[18px] w-[18px] text-sm text-white/50" type="chevron-right"></media-icon> </media-menu-button> <!-- Caption Submenu Items --> <media-menu-items class="hidden w-full flex-col items-start justify-center outline-none data-[keyboard]:mt-[3px] data-[open]:inline-block"> <media-captions-radio-group class="flex w-full flex-col"> <template> <media-radio class="ring-media-focus group relative flex w-full cursor-pointer select-none items-center justify-start rounded-sm p-2.5 outline-none data-[hocus]:bg-white/10 data-[focus]:ring-[3px]"> <media-icon class="h-4 w-4 group-data-[checked]:hidden" type="radio-button"></media-icon> <media-icon class="text-media-brand hidden h-4 w-4 group-data-[checked]:block" type="radio-button-selected"></media-icon> <span class="ml-2" data-part="label"></span> </media-radio> </template> </media-captions-radio-group> </media-menu-items> </media-menu> </media-menu-items> </media-menu> <!-- PIP Button --> <media-tooltip> <media-tooltip-trigger> <media-pip-button class="ring-media-focus group relative mr-0.5 inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="media-pip:hidden h-8 w-8" type="picture-in-picture"></media-icon> <media-icon class="media-pip:block hidden h-8 w-8" type="picture-in-picture-exit"></media-icon> </media-pip-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top" offset="30"> <span class="media-pip:hidden">Enter PIP</span> <span class="media-pip:block hidden">Exit PIP</span> </media-tooltip-content> </media-tooltip> <!-- Fullscreen Button --> <media-tooltip> <media-tooltip-trigger> <media-fullscreen-button class="ring-media-focus group relative inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="media-fullscreen:hidden h-8 w-8" type="fullscreen"></media-icon> <media-icon class="media-fullscreen:block hidden h-8 w-8" type="fullscreen-exit"></media-icon> </media-fullscreen-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top end" offset="30"> <span class="media-fullscreen:hidden">Enter Fullscreen</span> <span class="media-fullscreen:block hidden">Exit Fullscreen</span> </media-tooltip-content> </media-tooltip> </media-controls-group> </media-controls> </media-player>
<h3 id="net-in-ubuntu-and-chiseled-containers---canonical--microsoft">.NET in Ubuntu and Chiseled Containers - Canonical &amp; Microsoft</h3>
<blockquote>
<p>Folks at Microsoft reached out to Canonical with a “simple” request, for Ubuntu distroless container images. The two companies partnered together to produce super small and secure container images, about 100MB smaller than regular container images. You can start using these images now, for much better performance.</p>
</blockquote>
<media-player class="ring-media-focus aspect-video w-full overflow-hidden rounded-md bg-slate-950 font-sans text-white data-[focus]:ring-4" title="Laurent Kempé" src="youtube/pnsYc8GskCw" crossorigin="true" playsinline clip-start-time="0"> <media-provider> <source src="youtube/pnsYc8GskCw"> </media-provider> <!-- Gestures --> <media-gesture class="absolute inset-0 z-0 block h-full w-full" event="pointerup" action="toggle:paused"></media-gesture> <media-gesture class="absolute inset-0 z-0 block h-full w-full" event="dblpointerup" action="toggle:fullscreen"></media-gesture> <media-gesture class="absolute left-0 top-0 z-10 block h-full w-1/5" event="dblpointerup" action="seek:-10"></media-gesture> <media-gesture class="absolute right-0 top-0 z-10 block h-full w-1/5" event="dblpointerup" action="seek:10"></media-gesture> <!-- Captions --> <media-captions class="media-preview:opacity-0 media-controls:bottom-[85px] media-captions:opacity-100 absolute inset-0 bottom-2 z-10 select-none break-words opacity-0 transition-[opacity,bottom] duration-300"></media-captions> <!-- Controls --> <media-controls class="media-controls:opacity-100 absolute inset-0 z-10 flex h-full w-full flex-col bg-gradient-to-t from-black/10 to-transparent opacity-0 transition-opacity"> <div class="pointer-events-none flex-1"></div> <media-controls-group class="flex w-full items-center px-2"> <!-- Time Slider --> <media-time-slider class="group relative mx-[7.5px] inline-flex h-10 w-full cursor-pointer touch-none select-none items-center outline-none"> <media-slider-chapters class="relative flex h-full w-full items-center rounded-[1px]"> <template> <!-- Slider Chapter --> <div class="last-child:mr-0 relative mr-0.5 flex h-full w-full items-center rounded-[1px]" style="contain: layout style"> <!-- Slider Chapter Track --> <div class="ring-media-focus relative z-0 h-[5px] w-full rounded-sm bg-white/30 group-data-[focus]:ring-[3px]"> <div class="bg-media-brand absolute h-full w-[var(--chapter-fill)] rounded-sm will-change-[width]"></div> <div class="absolute z-10 h-full w-[var(--chapter-progress)] rounded-sm bg-white/50 will-change-[width]"></div> </div> </div> </template> </media-slider-chapters> <!-- Slider Thumb --> <div class="absolute left-[var(--slider-fill)] top-1/2 z-20 h-[15px] w-[15px] -translate-x-1/2 -translate-y-1/2 rounded-full border border-[#cacaca] bg-white opacity-0 ring-white/40 transition-opacity will-change-[left] group-data-[active]:opacity-100 group-data-[dragging]:ring-4"></div> <!-- Slider Preview --> <media-slider-preview class="pointer-events-none flex flex-col items-center opacity-0 transition-opacity duration-200 data-[visible]:opacity-100"> <media-slider-thumbnail class="block h-[var(--thumbnail-height)] max-h-[160px] min-h-[80px] w-[var(--thumbnail-width)] min-w-[120px] max-w-[180px] overflow-hidden border border-white bg-black" src="https://files.vidstack.io/sprite-fight/thumbnails.vtt"></media-slider-thumbnail> <div class="mt-1 text-sm" data-part="chapter-title"></div> <media-slider-value class="text-[13px]"></media-slider-value> </media-slider-preview> </media-time-slider> </media-controls-group> <media-controls-group class="-mt-0.5 flex w-full items-center px-2 pb-2"> <!-- Play Button --> <media-tooltip> <media-tooltip-trigger> <media-play-button class="ring-media-focus relative inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="media-paused:block hidden h-8 w-8" type="play"></media-icon> <media-icon class="media-paused:hidden h-8 w-8" type="pause"></media-icon> </media-play-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top start" offset="30"> <span class="media-paused:block hidden">Play</span> <span class="media-paused:hidden">Pause</span> </media-tooltip-content> </media-tooltip> <!-- Mute Button --> <media-tooltip> <media-tooltip-trigger> <media-mute-button class="ring-media-focus group relative -mr-1.5 inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="hidden h-8 w-8 group-data-[state='muted']:block" type="mute"></media-icon> <media-icon class="hidden h-8 w-8 group-data-[state='low']:block" type="volume-low"></media-icon> <media-icon class="hidden h-8 w-8 group-data-[state='high']:block" type="volume-high"></media-icon> </media-mute-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top" offset="30"> <span class="media-muted:hidden">Mute</span> <span class="media-muted:block hidden">Unmute</span> </media-tooltip-content> </media-tooltip> <!-- Volume Slider --> <media-volume-slider class="group relative mx-[7.5px] inline-flex h-10 w-full max-w-[80px] cursor-pointer touch-none select-none items-center outline-none"> <!-- Slider Track --> <div class="ring-media-focus relative z-0 h-[5px] w-full rounded-sm bg-white/30 group-data-[focus]:ring-[3px]"> <div class="bg-media-brand absolute h-full w-[var(--slider-fill)] rounded-sm will-change-[width]"></div> </div> <!-- Slider Thumb --> <div class="absolute left-[var(--slider-fill)] top-1/2 z-20 h-[15px] w-[15px] -translate-x-1/2 -translate-y-1/2 rounded-full border border-[#cacaca] bg-white opacity-0 ring-white/40 transition-opacity will-change-[left] group-data-[active]:opacity-100 group-data-[dragging]:ring-4"></div> <media-slider-preview class="pointer-events-none opacity-0 transition-opacity duration-200 data-[visible]:opacity-100" no-clamp="true" offset="30"> <media-slider-value class="rounded-sm bg-black px-2 py-px text-[13px] font-medium"></media-slider-value> </media-slider-preview> </media-volume-slider> <!-- Time Group --> <div class="ml-1.5 flex items-center text-sm font-medium"> <media-time type="current"></media-time> <div class="mx-1 text-white/80">/</div> <media-time type="duration"></media-time> </div> <span class="inline-block flex-1 overflow-hidden text-ellipsis whitespace-nowrap px-2 text-sm font-medium text-white/70"> <span class="mr-1">|</span> <media-chapter-title></media-chapter-title> </span> <!-- Caption Button --> <media-tooltip> <media-tooltip-trigger> <media-caption-button class="ring-media-focus group relative mr-0.5 inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="media-captions:block hidden h-8 w-8" type="closed-captions-on"></media-icon> <media-icon class="media-captions:hidden h-8 w-8" type="closed-captions"></media-icon> </media-caption-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top" offset="30"> <span class="media-captions:block hidden">Closed-Captions Off</span> <span class="media-captions:hidden">Closed-Captions On</span> </media-tooltip-content> </media-tooltip> <!-- Settings Menu --> <media-menu class="group"> <!-- Settings Menu Button --> <media-tooltip> <media-tooltip-trigger> <media-menu-button class="ring-media-focus relative mr-0.5 inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 aria-hidden:hidden data-[focus]:ring-4"> <media-icon class="h-8 w-8 transform transition-transform duration-200 ease-out group-data-[open]:rotate-90" type="settings"></media-icon> </media-menu-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white group-data-[open]:hidden" placement="top" offset="30">
Settings
</media-tooltip-content> </media-tooltip> <!-- Settings Menu Items --> <media-menu-items class="animate-out fade-out slide-out-to-bottom-2 data-[open]:animate-in data-[open]:fade-in data-[open]:slide-in-from-bottom-4 flex h-[var(--menu-height)] max-h-[400px] min-w-[260px] flex-col overflow-y-auto overscroll-y-contain rounded-md border border-white/10 bg-black/95 p-2.5 font-sans text-[15px] font-medium outline-none backdrop-blur-sm transition-[height] duration-300 will-change-[height] data-[resizing]:overflow-hidden" offset="30" placement="top end"> <!-- Caption Submenu --> <media-menu> <!-- Caption Submenu Button --> <media-menu-button class="ring-media-focus parent left-0 z-10 flex w-full cursor-pointer select-none items-center justify-start rounded-sm bg-black/60 p-2.5 outline-none ring-inset aria-disabled:hidden aria-hidden:hidden data-[open]:sticky data-[open]:-top-2.5 data-[hocus]:bg-white/10 data-[focus]:ring-[3px]"> <!-- Close Icon --> <media-icon class="parent-data-[open]:block -ml-0.5 mr-1.5 hidden h-[18px] w-[18px]" type="chevron-left"></media-icon> <!-- Icon --> <media-icon class="parent-data-[open]:hidden mr-1.5 h-5 w-5" type="closed-captions"></media-icon> <!-- Label --> <span>Captions</span> <!-- Hint --> <span class="ml-auto text-sm text-white/50" data-part="hint"></span> <!-- Open Icon --> <media-icon class="parent-data-[open]:hidden ml-0.5 h-[18px] w-[18px] text-sm text-white/50" type="chevron-right"></media-icon> </media-menu-button> <!-- Caption Submenu Items --> <media-menu-items class="hidden w-full flex-col items-start justify-center outline-none data-[keyboard]:mt-[3px] data-[open]:inline-block"> <media-captions-radio-group class="flex w-full flex-col"> <template> <media-radio class="ring-media-focus group relative flex w-full cursor-pointer select-none items-center justify-start rounded-sm p-2.5 outline-none data-[hocus]:bg-white/10 data-[focus]:ring-[3px]"> <media-icon class="h-4 w-4 group-data-[checked]:hidden" type="radio-button"></media-icon> <media-icon class="text-media-brand hidden h-4 w-4 group-data-[checked]:block" type="radio-button-selected"></media-icon> <span class="ml-2" data-part="label"></span> </media-radio> </template> </media-captions-radio-group> </media-menu-items> </media-menu> </media-menu-items> </media-menu> <!-- PIP Button --> <media-tooltip> <media-tooltip-trigger> <media-pip-button class="ring-media-focus group relative mr-0.5 inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="media-pip:hidden h-8 w-8" type="picture-in-picture"></media-icon> <media-icon class="media-pip:block hidden h-8 w-8" type="picture-in-picture-exit"></media-icon> </media-pip-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top" offset="30"> <span class="media-pip:hidden">Enter PIP</span> <span class="media-pip:block hidden">Exit PIP</span> </media-tooltip-content> </media-tooltip> <!-- Fullscreen Button --> <media-tooltip> <media-tooltip-trigger> <media-fullscreen-button class="ring-media-focus group relative inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"> <media-icon class="media-fullscreen:hidden h-8 w-8" type="fullscreen"></media-icon> <media-icon class="media-fullscreen:block hidden h-8 w-8" type="fullscreen-exit"></media-icon> </media-fullscreen-button> </media-tooltip-trigger> <media-tooltip-content class="animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white" placement="top end" offset="30"> <span class="media-fullscreen:hidden">Enter Fullscreen</span> <span class="media-fullscreen:block hidden">Exit Fullscreen</span> </media-tooltip-content> </media-tooltip> </media-controls-group> </media-controls> </media-player>
<h1 id="references">References</h1>
<ul>
<li><a href="https://devblogs.microsoft.com/dotnet/dotnet-6-is-now-in-ubuntu-2204/#net-in-chiseled-ubuntu-containers">.NET in Chiseled Ubuntu Containers</a></li>
<li><a href="https://devblogs.microsoft.com/dotnet/announcing-builtin-container-support-for-the-dotnet-sdk/">Announcing built-in container support for the .NET SDK</a></li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/core/whats-new/dotnet-7#publish-to-a-container">Publish to a container</a></li>
<li><a href="https://github.com/dotnet/sdk-container-builds">dotnet / sdk-container-builds</a></li>
<li><a href="https://github.com/dotnet/runtime/blob/main/docs/design/features/globalization-invariant-mode.md">.NET Core Globalization Invariant Mode</a></li>
<li><a href="https://devdevdev.net/">devdevdev.net</a></li>
</ul> </article>  </div>  </div> <footer class="py-8"> <div class="container mx-auto gap-4 px-4 text-sm text-gray-600 dark:text-gray-300 text-center"> <div>
&copy; 2025 Laurent Kempé. All rights reserved.
</div> <div>
The expressed opinions are my own and do not reflect those of my employer or any third-party entities.
</div> </div> </footer> <script>
            const theme = (() => {
              if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
                return localStorage.getItem("theme");
              }
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                return "dark";
              }
              return "light";
            })();
          
            if (theme === "light") {
              document.documentElement.classList.remove("dark");
            } else {
              document.documentElement.classList.add("dark");
            }
            window.localStorage.setItem("theme", theme);
        </script> <script src="https://cdn.vidstack.io/player.core" type="module"></script> <script src="https://cdn.vidstack.io/icons" type="module"></script> </body> </html> 